/*! For license information please see 17.f3511ae2da8a0f90f7bf.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{Iab2:function(l,n,e){var u,t;void 0===(t="function"==typeof(u=function(){"use strict";function n(l,n,e){var u=new XMLHttpRequest;u.open("GET",l),u.responseType="blob",u.onload=function(){a(u.response,n,e)},u.onerror=function(){console.error("could not download file")},u.send()}function e(l){var n=new XMLHttpRequest;n.open("HEAD",l,!1);try{n.send()}catch(l){}return 200<=n.status&&299>=n.status}function u(l){try{l.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),l.dispatchEvent(e)}}var t="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,a=t.saveAs||("object"!=typeof window||window!==t?function(){}:"download"in HTMLAnchorElement.prototype?function(l,a,r){var o=t.URL||t.webkitURL,s=document.createElement("a");s.download=a=a||l.name||"download",s.rel="noopener","string"==typeof l?(s.href=l,s.origin===location.origin?u(s):e(s.href)?n(l,a,r):u(s,s.target="_blank")):(s.href=o.createObjectURL(l),setTimeout((function(){o.revokeObjectURL(s.href)}),4e4),setTimeout((function(){u(s)}),0))}:"msSaveOrOpenBlob"in navigator?function(l,t,a){if(t=t||l.name||"download","string"!=typeof l)navigator.msSaveOrOpenBlob(function(l,n){return void 0===n?n={autoBom:!1}:"object"!=typeof n&&(console.warn("Deprecated: Expected third argument to be a object"),n={autoBom:!n}),n.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(l.type)?new Blob(["\ufeff",l],{type:l.type}):l}(l,a),t);else if(e(l))n(l,t,a);else{var r=document.createElement("a");r.href=l,r.target="_blank",setTimeout((function(){u(r)}))}}:function(l,e,u,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof l)return n(l,e,u);var r="application/octet-stream"===l.type,o=/constructor/i.test(t.HTMLElement)||t.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||r&&o)&&"object"==typeof FileReader){var i=new FileReader;i.onloadend=function(){var l=i.result;l=s?l:l.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=l:location=l,a=null},i.readAsDataURL(l)}else{var c=t.URL||t.webkitURL,b=c.createObjectURL(l);a?a.location=b:location.href=b,a=null,setTimeout((function(){c.revokeObjectURL(b)}),4e4)}});t.saveAs=a.saveAs=a,l.exports=a})?u.apply(n,[]):u)||(l.exports=t)},XiiS:function(l,n,e){"use strict";e.r(n);var u=e("8Y7J");class t{}var a=e("pMnS"),r=e("9AJC"),o=e("dix8"),s=e("ufrD"),i=e("SVse"),c=e("iInd"),b=e("IzEk"),d=e("HDdC"),p=e("vkgz"),h=e("Iab2"),g=e("wBwE"),m=e("cm5s"),f=e("Osig"),v=e("8PDw"),C=e("iA0r"),y=e("wN9v"),q=e("EQDH");class k{constructor(){this.recordIds=[],this.overlayMap={}}}class T{constructor(l,n,e,u,t,a,r,o){this.http=l,this.idl=n,this.org=e,this.evt=u,this.net=t,this.auth=a,this.pcrud=r,this.perm=o,this.attrDefs={},this.allQueues={},this.matchSets={},this.importSelection=null,this.queuePageOffset=0}getAttrDefs(l){if(this.attrDefs[l])return Promise.resolve(this.attrDefs[l]);const n="bib"===l?"vqbrad":"vqarad",e={};return e[n]="id",this.pcrud.retrieveAll(n,{order_by:e},{atomic:!0}).toPromise().then(n=>(this.attrDefs[l]=n,n))}getMergeProfiles(){if(this.mergeProfiles)return Promise.resolve(this.mergeProfiles);const l=this.org.ancestors(this.auth.user().ws_ou(),!0);return this.pcrud.search("vmp",{owner:l},{order_by:{vmp:["name"]}},{atomic:!0}).toPromise().then(l=>(this.mergeProfiles=l,l))}getAllQueues(l){return this.allQueues[l]?Promise.resolve(this.allQueues[l]):(this.allQueues[l]=[],this.net.request("open-ils.vandelay",`open-ils.vandelay.${l}_queue.owner.retrieve`,this.auth.token()).pipe(Object(p.a)(n=>this.allQueues[l].push(n))).toPromise().then(()=>this.allQueues[l]))}getBibSources(){return this.bibSources?Promise.resolve(this.bibSources):this.pcrud.retrieveAll("cbs",{order_by:{cbs:"id"}},{atomic:!0}).toPromise().then(l=>(this.bibSources=l,l))}getItemImportDefs(){if(this.importItemAttrDefs)return Promise.resolve(this.importItemAttrDefs);const l=this.org.ancestors(this.auth.user().ws_ou(),!0);return this.pcrud.search("viiad",{owner:l},{},{atomic:!0}).toPromise().then(l=>(this.importItemAttrDefs=l,l))}getMatchSets(l){const n=l.match(/bib/)?"biblio":"authority";if(this.matchSets[l])return Promise.resolve(this.matchSets[l]);this.matchSets[l]=[];const e=this.org.ancestors(this.auth.user().ws_ou(),!0);return this.pcrud.search("vms",{owner:e,mtype:n},{},{atomic:!0}).toPromise().then(n=>(this.matchSets[l]=n,n))}getBibBuckets(){return this.bibBuckets?Promise.resolve(this.bibBuckets):this.net.request("open-ils.actor","open-ils.actor.container.retrieve_by_class",this.auth.token(),this.auth.user().id(),"biblio","staff_client").toPromise().then(l=>(this.bibBuckets=l,l))}getCopyStatuses(){return this.copyStatuses?Promise.resolve(this.copyStatuses):this.pcrud.retrieveAll("ccs",{},{atomic:!0}).toPromise().then(l=>(this.copyStatuses=l,l))}getBibTrashGroups(){if(this.bibTrashGroups)return Promise.resolve(this.bibTrashGroups);const l=this.org.ancestors(this.auth.user().ws_ou(),!0);return this.pcrud.search("vibtg",{always_apply:"f",owner:l},{vibtg:["label"]},{atomic:!0}).toPromise().then(l=>(this.bibTrashGroups=l,l))}createQueue(l,n,e,u,t){const a=`open-ils.vandelay.${n}_queue.create`;let r=n;return n.match(/bib_acq/)&&(r="acq"),new Promise((n,o)=>{this.net.request("open-ils.vandelay",a,this.auth.token(),l,null,r,u,e,t).subscribe(l=>{const e=this.evt.parse(l);e?o(e):(this.allQueues[r].push(l),n(l.id()))})})}getQueuedRecords(l,n,e,u){const t=n.match(/bib/)?"bib":"auth";let a=`open-ils.vandelay.${t}_queue.records.retrieve`;return u&&(a=`open-ils.vandelay.${t}_queue.records.matches.retrieve`),this.net.request("open-ils.vandelay",a,this.auth.token(),l,e)}exportQueue(l,n){let e=`/exporter?type=${l.queue_type().match(/auth/)?"auth":"bib"}&queueid=${l.id()}`,u=l.name();n&&(e+="&nonimported=1",u+="_nonimported"),u+=".mrc",this.http.get(e,{responseType:"text"}).subscribe(l=>{Object(h.saveAs)(new Blob([l],{type:"application/octet-stream"}),u)},l=>{console.error(l)})}pollSessionTracker(l){return new d.a(n=>{this.getNextSessionTracker(l,n)})}getNextSessionTracker(l,n){this.pcrud.retrieve("vst",l).subscribe(e=>{e&&"active"===e.state()?(n.next(e),setTimeout(()=>this.getNextSessionTracker(l,n),2e3)):(console.debug(`Vandelay session tracker ${l} is ${e.state()}`),n.complete())})}}class I{constructor(l,n,e){this.router=l,this.route=n,this.vandelay=e,this.router.events.subscribe(l=>{l instanceof c.d&&this.route.firstChild.url.pipe(Object(b.a)(1)).subscribe(l=>this.tab=l[0].path)})}ngOnInit(){}ngAfterViewInit(){}}var S=u.ob({encapsulation:2,styles:[],data:{}});function w(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"eg-staff-banner",[["bannerText","MARC Batch Import/Export"]],null,null,null,o.b,o.a)),u.pb(1,49152,null,0,s.a,[],{bannerText:[0,"bannerText"]},null),(l()(),u.qb(2,0,null,null,56,"ul",[["class","nav nav-pills nav-fill pb-4"]],null,null,null,null,null)),(l()(),u.qb(3,0,null,null,6,"li",[["class","nav-item"]],null,null,null,null,null)),(l()(),u.qb(4,0,null,null,5,"a",[["class","nav-link"],["routerLink","/staff/cat/vandelay/export"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,8).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),t}),null,null)),u.Hb(512,null,i.N,i.O,[u.r,u.s,u.k,u.C]),u.pb(6,278528,null,0,i.n,[i.N],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),u.Fb(7,{active:0}),u.pb(8,671744,null,0,c.n,[c.l,c.a,i.m],{routerLink:[0,"routerLink"]},null),(l()(),u.Kb(-1,null,["Export"])),(l()(),u.qb(10,0,null,null,6,"li",[["class","nav-item"]],null,null,null,null,null)),(l()(),u.qb(11,0,null,null,5,"a",[["class","nav-link"],["routerLink","/staff/cat/vandelay/import"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,15).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),t}),null,null)),u.Hb(512,null,i.N,i.O,[u.r,u.s,u.k,u.C]),u.pb(13,278528,null,0,i.n,[i.N],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),u.Fb(14,{active:0}),u.pb(15,671744,null,0,c.n,[c.l,c.a,i.m],{routerLink:[0,"routerLink"]},null),(l()(),u.Kb(-1,null,["Import"])),(l()(),u.qb(17,0,null,null,6,"li",[["class","nav-item"]],null,null,null,null,null)),(l()(),u.qb(18,0,null,null,5,"a",[["class","nav-link"],["routerLink","/staff/cat/vandelay/queue"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,22).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),t}),null,null)),u.Hb(512,null,i.N,i.O,[u.r,u.s,u.k,u.C]),u.pb(20,278528,null,0,i.n,[i.N],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),u.Fb(21,{active:0}),u.pb(22,671744,null,0,c.n,[c.l,c.a,i.m],{routerLink:[0,"routerLink"]},null),(l()(),u.Kb(-1,null,["Inspect Queue"])),(l()(),u.qb(24,0,null,null,6,"li",[["class","nav-item"]],null,null,null,null,null)),(l()(),u.qb(25,0,null,null,5,"a",[["class","nav-link"],["routerLink","/staff/cat/vandelay/display_attrs/bib"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,29).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),t}),null,null)),u.Hb(512,null,i.N,i.O,[u.r,u.s,u.k,u.C]),u.pb(27,278528,null,0,i.n,[i.N],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),u.Fb(28,{active:0}),u.pb(29,671744,null,0,c.n,[c.l,c.a,i.m],{routerLink:[0,"routerLink"]},null),(l()(),u.Kb(-1,null,["Record Display Attributes"])),(l()(),u.qb(31,0,null,null,6,"li",[["class","nav-item"]],null,null,null,null,null)),(l()(),u.qb(32,0,null,null,5,"a",[["class","nav-link"],["routerLink","/staff/cat/vandelay/merge_profiles"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,36).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),t}),null,null)),u.Hb(512,null,i.N,i.O,[u.r,u.s,u.k,u.C]),u.pb(34,278528,null,0,i.n,[i.N],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),u.Fb(35,{active:0}),u.pb(36,671744,null,0,c.n,[c.l,c.a,i.m],{routerLink:[0,"routerLink"]},null),(l()(),u.Kb(-1,null,["Merge / Overlay Profiles"])),(l()(),u.qb(38,0,null,null,6,"li",[["class","nav-item"]],null,null,null,null,null)),(l()(),u.qb(39,0,null,null,5,"a",[["class","nav-link"],["routerLink","/staff/cat/vandelay/match_sets"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,43).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),t}),null,null)),u.Hb(512,null,i.N,i.O,[u.r,u.s,u.k,u.C]),u.pb(41,278528,null,0,i.n,[i.N],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),u.Fb(42,{active:0}),u.pb(43,671744,null,0,c.n,[c.l,c.a,i.m],{routerLink:[0,"routerLink"]},null),(l()(),u.Kb(-1,null,["Record Match Sets"])),(l()(),u.qb(45,0,null,null,6,"li",[["class","nav-item"]],null,null,null,null,null)),(l()(),u.qb(46,0,null,null,5,"a",[["class","nav-link"],["routerLink","/staff/cat/vandelay/holdings_profiles"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,50).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),t}),null,null)),u.Hb(512,null,i.N,i.O,[u.r,u.s,u.k,u.C]),u.pb(48,278528,null,0,i.n,[i.N],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),u.Fb(49,{active:0}),u.pb(50,671744,null,0,c.n,[c.l,c.a,i.m],{routerLink:[0,"routerLink"]},null),(l()(),u.Kb(-1,null,["Holdings Import Profiles"])),(l()(),u.qb(52,0,null,null,6,"li",[["class","nav-item"]],null,null,null,null,null)),(l()(),u.qb(53,0,null,null,5,"a",[["class","nav-link"],["routerLink","/staff/cat/vandelay/active_imports"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,57).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),t}),null,null)),u.Hb(512,null,i.N,i.O,[u.r,u.s,u.k,u.C]),u.pb(55,278528,null,0,i.n,[i.N],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),u.Fb(56,{active:0}),u.pb(57,671744,null,0,c.n,[c.l,c.a,i.m],{routerLink:[0,"routerLink"]},null),(l()(),u.Kb(-1,null,["Recent Imports"])),(l()(),u.qb(59,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),u.pb(60,212992,null,0,c.p,[c.b,u.N,u.j,[8,null],u.h],null,null)],(function(l,n){var e=n.component;l(n,1,0,"MARC Batch Import/Export");var u=l(n,7,0,"export"==e.tab);l(n,6,0,"nav-link",u),l(n,8,0,"/staff/cat/vandelay/export");var t=l(n,14,0,"import"==e.tab);l(n,13,0,"nav-link",t),l(n,15,0,"/staff/cat/vandelay/import");var a=l(n,21,0,"queue"==e.tab);l(n,20,0,"nav-link",a),l(n,22,0,"/staff/cat/vandelay/queue");var r=l(n,28,0,"display_attrs"==e.tab);l(n,27,0,"nav-link",r),l(n,29,0,"/staff/cat/vandelay/display_attrs/bib");var o=l(n,35,0,"merge_profiles"==e.tab);l(n,34,0,"nav-link",o),l(n,36,0,"/staff/cat/vandelay/merge_profiles");var s=l(n,42,0,"match_sets"==e.tab);l(n,41,0,"nav-link",s),l(n,43,0,"/staff/cat/vandelay/match_sets");var i=l(n,49,0,"holdings_profiles"==e.tab);l(n,48,0,"nav-link",i),l(n,50,0,"/staff/cat/vandelay/holdings_profiles");var c=l(n,56,0,"active_imports"==e.tab);l(n,55,0,"nav-link",c),l(n,57,0,"/staff/cat/vandelay/active_imports"),l(n,60,0)}),(function(l,n){l(n,4,0,u.Cb(n,8).target,u.Cb(n,8).href),l(n,11,0,u.Cb(n,15).target,u.Cb(n,15).href),l(n,18,0,u.Cb(n,22).target,u.Cb(n,22).href),l(n,25,0,u.Cb(n,29).target,u.Cb(n,29).href),l(n,32,0,u.Cb(n,36).target,u.Cb(n,36).href),l(n,39,0,u.Cb(n,43).target,u.Cb(n,43).href),l(n,46,0,u.Cb(n,50).target,u.Cb(n,50).href),l(n,53,0,u.Cb(n,57).target,u.Cb(n,57).href)}))}function M(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"ng-component",[],null,null,null,w,S)),u.pb(1,4308992,null,0,I,[c.l,c.a,T],null,null)],(function(l,n){l(n,1,0)}),null)}var K=u.mb("ng-component",I,M,{},{},[]),_=e("s7LF"),x=e("taEJ"),P=e("/xpB"),A=e("G0yt"),R=e("nUl2"),N=e("9rfo"),O=e("OXuP"),E=e("a07c"),D=e("ib0n"),L=e("RvO3"),F=e("TxlL"),Q=e("YRS1"),H=e("LRne"),B=e("bOdf"),U=e("pLZG"),j=e("lJxs");class G{}class z{}class ${constructor(l){this.normalizedNames=new Map,this.lazyUpdate=null,l?this.lazyInit="string"==typeof l?()=>{this.headers=new Map,l.split("\n").forEach(l=>{const n=l.indexOf(":");if(n>0){const e=l.slice(0,n),u=e.toLowerCase(),t=l.slice(n+1).trim();this.maybeSetNormalizedName(e,u),this.headers.has(u)?this.headers.get(u).push(t):this.headers.set(u,[t])}})}:()=>{this.headers=new Map,Object.keys(l).forEach(n=>{let e=l[n];const u=n.toLowerCase();"string"==typeof e&&(e=[e]),e.length>0&&(this.headers.set(u,e),this.maybeSetNormalizedName(n,u))})}:this.headers=new Map}has(l){return this.init(),this.headers.has(l.toLowerCase())}get(l){this.init();const n=this.headers.get(l.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(l){return this.init(),this.headers.get(l.toLowerCase())||null}append(l,n){return this.clone({name:l,value:n,op:"a"})}set(l,n){return this.clone({name:l,value:n,op:"s"})}delete(l,n){return this.clone({name:l,value:n,op:"d"})}maybeSetNormalizedName(l,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,l)}init(){this.lazyInit&&(this.lazyInit instanceof $?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(l=>this.applyUpdate(l)),this.lazyUpdate=null))}copyFrom(l){l.init(),Array.from(l.headers.keys()).forEach(n=>{this.headers.set(n,l.headers.get(n)),this.normalizedNames.set(n,l.normalizedNames.get(n))})}clone(l){const n=new $;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof $?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([l]),n}applyUpdate(l){const n=l.name.toLowerCase();switch(l.op){case"a":case"s":let e=l.value;if("string"==typeof e&&(e=[e]),0===e.length)return;this.maybeSetNormalizedName(l.name,n);const u=("a"===l.op?this.headers.get(n):void 0)||[];u.push(...e),this.headers.set(n,u);break;case"d":const t=l.value;if(t){let l=this.headers.get(n);if(!l)return;l=l.filter(l=>-1===t.indexOf(l)),0===l.length?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,l)}else this.headers.delete(n),this.normalizedNames.delete(n)}}forEach(l){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>l(this.normalizedNames.get(n),this.headers.get(n)))}}class V{encodeKey(l){return X(l)}encodeValue(l){return X(l)}decodeKey(l){return decodeURIComponent(l)}decodeValue(l){return decodeURIComponent(l)}}function X(l){return encodeURIComponent(l).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}class J{constructor(l={}){if(this.updates=null,this.cloneFrom=null,this.encoder=l.encoder||new V,l.fromString){if(l.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(l,n){const e=new Map;return l.length>0&&l.split("&").forEach(l=>{const u=l.indexOf("="),[t,a]=-1==u?[n.decodeKey(l),""]:[n.decodeKey(l.slice(0,u)),n.decodeValue(l.slice(u+1))],r=e.get(t)||[];r.push(a),e.set(t,r)}),e}(l.fromString,this.encoder)}else l.fromObject?(this.map=new Map,Object.keys(l.fromObject).forEach(n=>{const e=l.fromObject[n];this.map.set(n,Array.isArray(e)?e:[e])})):this.map=null}has(l){return this.init(),this.map.has(l)}get(l){this.init();const n=this.map.get(l);return n?n[0]:null}getAll(l){return this.init(),this.map.get(l)||null}keys(){return this.init(),Array.from(this.map.keys())}append(l,n){return this.clone({param:l,value:n,op:"a"})}set(l,n){return this.clone({param:l,value:n,op:"s"})}delete(l,n){return this.clone({param:l,value:n,op:"d"})}toString(){return this.init(),this.keys().map(l=>{const n=this.encoder.encodeKey(l);return this.map.get(l).map(l=>n+"="+this.encoder.encodeValue(l)).join("&")}).join("&")}clone(l){const n=new J({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat([l]),n}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(l=>this.map.set(l,this.cloneFrom.map.get(l))),this.updates.forEach(l=>{switch(l.op){case"a":case"s":const n=("a"===l.op?this.map.get(l.param):void 0)||[];n.push(l.value),this.map.set(l.param,n);break;case"d":if(void 0===l.value){this.map.delete(l.param);break}{let n=this.map.get(l.param)||[];const e=n.indexOf(l.value);-1!==e&&n.splice(e,1),n.length>0?this.map.set(l.param,n):this.map.delete(l.param)}}}),this.cloneFrom=this.updates=null)}}function W(l){return"undefined"!=typeof ArrayBuffer&&l instanceof ArrayBuffer}function Z(l){return"undefined"!=typeof Blob&&l instanceof Blob}function Y(l){return"undefined"!=typeof FormData&&l instanceof FormData}class ll{constructor(l,n,e,u){let t;if(this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=l.toUpperCase(),function(l){switch(l){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||u?(this.body=void 0!==e?e:null,t=u):t=e,t&&(this.reportProgress=!!t.reportProgress,this.withCredentials=!!t.withCredentials,t.responseType&&(this.responseType=t.responseType),t.headers&&(this.headers=t.headers),t.params&&(this.params=t.params)),this.headers||(this.headers=new $),this.params){const l=this.params.toString();if(0===l.length)this.urlWithParams=n;else{const e=n.indexOf("?");this.urlWithParams=n+(-1===e?"?":e<n.length-1?"&":"")+l}}else this.params=new J,this.urlWithParams=n}serializeBody(){return null===this.body?null:W(this.body)||Z(this.body)||Y(this.body)||"string"==typeof this.body?this.body:this.body instanceof J?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Y(this.body)?null:Z(this.body)?this.body.type||null:W(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof J?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}clone(l={}){const n=l.method||this.method,e=l.url||this.url,u=l.responseType||this.responseType,t=void 0!==l.body?l.body:this.body,a=void 0!==l.withCredentials?l.withCredentials:this.withCredentials,r=void 0!==l.reportProgress?l.reportProgress:this.reportProgress;let o=l.headers||this.headers,s=l.params||this.params;return void 0!==l.setHeaders&&(o=Object.keys(l.setHeaders).reduce((n,e)=>n.set(e,l.setHeaders[e]),o)),l.setParams&&(s=Object.keys(l.setParams).reduce((n,e)=>n.set(e,l.setParams[e]),s)),new ll(n,e,t,{params:s,headers:o,reportProgress:r,responseType:u,withCredentials:a})}}const nl=function(){var l={Sent:0,UploadProgress:1,ResponseHeader:2,DownloadProgress:3,Response:4,User:5};return l[l.Sent]="Sent",l[l.UploadProgress]="UploadProgress",l[l.ResponseHeader]="ResponseHeader",l[l.DownloadProgress]="DownloadProgress",l[l.Response]="Response",l[l.User]="User",l}();class el{constructor(l,n=200,e="OK"){this.headers=l.headers||new $,this.status=void 0!==l.status?l.status:n,this.statusText=l.statusText||e,this.url=l.url||null,this.ok=this.status>=200&&this.status<300}}class ul extends el{constructor(l={}){super(l),this.type=nl.ResponseHeader}clone(l={}){return new ul({headers:l.headers||this.headers,status:void 0!==l.status?l.status:this.status,statusText:l.statusText||this.statusText,url:l.url||this.url||void 0})}}class tl extends el{constructor(l={}){super(l),this.type=nl.Response,this.body=void 0!==l.body?l.body:null}clone(l={}){return new tl({body:void 0!==l.body?l.body:this.body,headers:l.headers||this.headers,status:void 0!==l.status?l.status:this.status,statusText:l.statusText||this.statusText,url:l.url||this.url||void 0})}}class al extends el{constructor(l){super(l,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?"Http failure during parsing for "+(l.url||"(unknown url)"):`Http failure response for ${l.url||"(unknown url)"}: ${l.status} ${l.statusText}`,this.error=l.error||null}}function rl(l,n){return{body:n,headers:l.headers,observe:l.observe,params:l.params,reportProgress:l.reportProgress,responseType:l.responseType,withCredentials:l.withCredentials}}class ol{constructor(l){this.handler=l}request(l,n,e={}){let u;if(l instanceof ll)u=l;else{let t=void 0;t=e.headers instanceof $?e.headers:new $(e.headers);let a=void 0;e.params&&(a=e.params instanceof J?e.params:new J({fromObject:e.params})),u=new ll(l,n,void 0!==e.body?e.body:null,{headers:t,params:a,reportProgress:e.reportProgress,responseType:e.responseType||"json",withCredentials:e.withCredentials})}const t=Object(H.a)(u).pipe(Object(B.a)(l=>this.handler.handle(l)));if(l instanceof ll||"events"===e.observe)return t;const a=t.pipe(Object(U.a)(l=>l instanceof tl));switch(e.observe||"body"){case"body":switch(u.responseType){case"arraybuffer":return a.pipe(Object(j.a)(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(Object(j.a)(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(Object(j.a)(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));case"json":default:return a.pipe(Object(j.a)(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${e.observe}}`)}}delete(l,n={}){return this.request("DELETE",l,n)}get(l,n={}){return this.request("GET",l,n)}head(l,n={}){return this.request("HEAD",l,n)}jsonp(l,n){return this.request("JSONP",l,{params:(new J).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(l,n={}){return this.request("OPTIONS",l,n)}patch(l,n,e={}){return this.request("PATCH",l,rl(e,n))}post(l,n,e={}){return this.request("POST",l,rl(e,n))}put(l,n,e={}){return this.request("PUT",l,rl(e,n))}}class sl{constructor(l,n){this.next=l,this.interceptor=n}handle(l){return this.interceptor.intercept(l,this.next)}}const il=new u.p("HTTP_INTERCEPTORS");class cl{intercept(l,n){return n.handle(l)}}const bl=/^\)\]\}',?\n/;class dl{}class pl{constructor(){}build(){return new XMLHttpRequest}}class hl{constructor(l){this.xhrFactory=l}handle(l){if("JSONP"===l.method)throw new Error("Attempted to construct Jsonp request without JsonpClientModule installed.");return new d.a(n=>{const e=this.xhrFactory.build();if(e.open(l.method,l.urlWithParams),l.withCredentials&&(e.withCredentials=!0),l.headers.forEach((l,n)=>e.setRequestHeader(l,n.join(","))),l.headers.has("Accept")||e.setRequestHeader("Accept","application/json, text/plain, */*"),!l.headers.has("Content-Type")){const n=l.detectContentTypeHeader();null!==n&&e.setRequestHeader("Content-Type",n)}if(l.responseType){const n=l.responseType.toLowerCase();e.responseType="json"!==n?n:"text"}const u=l.serializeBody();let t=null;const a=()=>{if(null!==t)return t;const n=1223===e.status?204:e.status,u=e.statusText||"OK",a=new $(e.getAllResponseHeaders()),r=function(l){return"responseURL"in l&&l.responseURL?l.responseURL:/^X-Request-URL:/m.test(l.getAllResponseHeaders())?l.getResponseHeader("X-Request-URL"):null}(e)||l.url;return t=new ul({headers:a,status:n,statusText:u,url:r}),t},r=()=>{let{headers:u,status:t,statusText:r,url:o}=a(),s=null;204!==t&&(s=void 0===e.response?e.responseText:e.response),0===t&&(t=s?200:0);let i=t>=200&&t<300;if("json"===l.responseType&&"string"==typeof s){const l=s;s=s.replace(bl,"");try{s=""!==s?JSON.parse(s):null}catch(c){s=l,i&&(i=!1,s={error:c,text:s})}}i?(n.next(new tl({body:s,headers:u,status:t,statusText:r,url:o||void 0})),n.complete()):n.error(new al({error:s,headers:u,status:t,statusText:r,url:o||void 0}))},o=l=>{const{url:u}=a(),t=new al({error:l,status:e.status||0,statusText:e.statusText||"Unknown Error",url:u||void 0});n.error(t)};let s=!1;const i=u=>{s||(n.next(a()),s=!0);let t={type:nl.DownloadProgress,loaded:u.loaded};u.lengthComputable&&(t.total=u.total),"text"===l.responseType&&e.responseText&&(t.partialText=e.responseText),n.next(t)},c=l=>{let e={type:nl.UploadProgress,loaded:l.loaded};l.lengthComputable&&(e.total=l.total),n.next(e)};return e.addEventListener("load",r),e.addEventListener("error",o),l.reportProgress&&(e.addEventListener("progress",i),null!==u&&e.upload&&e.upload.addEventListener("progress",c)),e.send(u),n.next({type:nl.Sent}),()=>{e.removeEventListener("error",o),e.removeEventListener("load",r),l.reportProgress&&(e.removeEventListener("progress",i),null!==u&&e.upload&&e.upload.removeEventListener("progress",c)),e.abort()}})}}const gl=new u.p("XSRF_COOKIE_NAME"),ml=new u.p("XSRF_HEADER_NAME");class fl{}class vl{constructor(l,n,e){this.doc=l,this.platform=n,this.cookieName=e,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const l=this.doc.cookie||"";return l!==this.lastCookieString&&(this.parseCount++,this.lastToken=Object(i.T)(l,this.cookieName),this.lastCookieString=l),this.lastToken}}class Cl{constructor(l,n){this.tokenService=l,this.headerName=n}intercept(l,n){const e=l.url.toLowerCase();if("GET"===l.method||"HEAD"===l.method||e.startsWith("http://")||e.startsWith("https://"))return n.handle(l);const u=this.tokenService.getToken();return null===u||l.headers.has(this.headerName)||(l=l.clone({headers:l.headers.set(this.headerName,u)})),n.handle(l)}}class yl{constructor(l,n){this.backend=l,this.injector=n,this.chain=null}handle(l){if(null===this.chain){const l=this.injector.get(il,[]);this.chain=l.reduceRight((l,n)=>new sl(l,n),this.backend)}return this.chain.handle(l)}}class ql{static disable(){return{ngModule:ql,providers:[{provide:Cl,useClass:cl}]}}static withOptions(l={}){return{ngModule:ql,providers:[l.cookieName?{provide:gl,useValue:l.cookieName}:[],l.headerName?{provide:ml,useValue:l.headerName}:[]]}}}class kl{}var Tl=e("OsfI");const Il=["recordType","selectedBibSource","selectedMatchSet","mergeOnExact","importNonMatching","mergeOnBestMatch","mergeOnSingleMatch","autoOverlayAcqCopies","autoOverlayOnOrderCopies","autoOverlayOrgUnitCopies","selectedHoldingsProfile","selectedMergeProfile","selectedFallThruMergeProfile","selectedTrashGroups","minQualityRatio"];class Sl{constructor(l,n,e,u,t,a,r,o){this.http=l,this.toast=n,this.evt=e,this.net=u,this.auth=t,this.org=a,this.store=r,this.vandelay=o,this.applyDefaults()}applyDefaults(){if(this.minQualityRatio=0,this.selectedBibSource=1,this.recordType="bib",this.bibTrashGroups=[],this.formTemplates={},this.vandelay.importSelection){if(!this.vandelay.importSelection.queue)return void(this.vandelay.importSelection=null);const l=this.vandelay.importSelection.queue;this.recordType=l.queue_type(),this.selectedMatchSet=l.match_set(),this.startQueueId=l.id(),"bib"===this.recordType&&(this.selectedBucket=l.match_bucket(),this.selectedHoldingsProfile=l.item_attr_def())}}ngOnInit(){}ngAfterViewInit(){this.loadStartupData()}ngOnDestroy(){this.clearSelection()}importSelection(){return this.vandelay.importSelection}loadStartupData(){const l=[this.vandelay.getMergeProfiles(),this.vandelay.getAllQueues("bib"),this.vandelay.getAllQueues("authority"),this.vandelay.getMatchSets("bib"),this.vandelay.getMatchSets("authority"),this.vandelay.getBibBuckets(),this.vandelay.getBibSources(),this.vandelay.getItemImportDefs(),this.vandelay.getBibTrashGroups().then(l=>this.bibTrashGroups=l),this.org.settings(["vandelay.default_match_set"]).then(l=>this.defaultMatchSet=l["vandelay.default_match_set"]),this.loadTemplates()];return Promise.all(l)}loadTemplates(){this.store.getItem("eg.cat.vandelay.import.templates").then(l=>{this.formTemplates=l||{},Object.keys(this.formTemplates).forEach(l=>{this.formTemplates[l].default&&(this.selectedTemplate=l)})})}formatTemplateEntries(){const l=[];return Object.keys(this.formTemplates||{}).forEach(n=>l.push({id:n,label:n})),l}formatEntries(l){const n=this.recordType;let e;switch(l){case"bibSources":return(this.vandelay.bibSources||[]).map(l=>({id:l.id(),label:l.source()}));case"bibBuckets":e=this.vandelay.bibBuckets;break;case"activeQueues":e=(this.vandelay.allQueues[n]||[]).filter(l=>"f"===l.complete());break;case"matchSets":e=this.vandelay.matchSets[n];break;case"importItemDefs":e=this.vandelay.importItemAttrDefs;break;case"mergeProfiles":e=this.vandelay.mergeProfiles}return(e||[]).map(l=>({id:l.id(),label:l.name()}))}selectEntry(l,n){const e=l?l.id:null;switch(n){case"recordType":this.recordType=e;break;case"bibSources":this.selectedBibSource=e;break;case"bibBuckets":this.selectedBucket=e;break;case"matchSets":this.selectedMatchSet=e;break;case"importItemDefs":this.selectedHoldingsProfile=e;break;case"mergeProfiles":this.selectedMergeProfile=e;break;case"FallThruMergeProfile":this.selectedFallThruMergeProfile=e}}fileSelected(l){this.selectedFile=l.target.files[0]}hasNeededData(){return this.vandelay.importSelection?this.importActionSelected():this.selectedQueue&&Boolean(this.recordType)&&Boolean(this.selectedFile)}importActionSelected(){return this.importNonMatching||this.mergeOnExact||this.mergeOnSingleMatch||this.mergeOnBestMatch}upload(){this.sessionKey=null,this.showProgress=!0,this.isUploading=!0,this.uploadComplete=!1,this.resetProgressBars(),this.resolveQueue().then(l=>(this.activeQueueId=l,this.uploadFile()),l=>Promise.reject("queue create failed")).then(l=>this.processSpool(),l=>Promise.reject("process spool failed")).then(l=>this.importRecords(),l=>Promise.reject("import records failed")).then(l=>{this.isUploading=!1,this.uploadComplete=!0},l=>{console.log("file upload failed: ",l),this.isUploading=!1,this.resetProgressBars()})}resetProgressBars(){this.uploadProgress.update({value:0,max:1}),this.enqueueProgress.update({value:0,max:1}),this.importProgress.update({value:0,max:1})}resolveQueue(){return this.selectedQueue.freetext?this.vandelay.createQueue(this.selectedQueue.label,this.recordType,this.selectedHoldingsProfile,this.selectedMatchSet,this.selectedBucket).then(l=>l,l=>{const n=this.evt.parse(l);return n&&(n.textcode.match(/QUEUE_EXISTS/)?this.dupeQueueAlert.open():alert(n)),Promise.reject("Queue Create Failed")}):Promise.resolve(this.selectedQueue.id)}uploadFile(){if(this.vandelay.importSelection)return Promise.resolve();const l=new FormData;l.append("ses",this.auth.token()),l.append("marc_upload",this.selectedFile,this.selectedFile.name),this.selectedBibSource&&l.append("bib_source",""+this.selectedBibSource);const n=new ll("POST","/vandelay-upload",l,{reportProgress:!0,responseType:"text"});return this.http.request(n).pipe(Object(p.a)(l=>{l.type===nl.UploadProgress?this.uploadProgress.update({value:l.loaded,max:l.total}):l instanceof tl&&(this.sessionKey=l.body,console.log("Vandelay file uploaded OK with key "+this.sessionKey))},l=>{console.error(l),this.toast.danger(l.error)})).toPromise()}processSpool(){if(this.vandelay.importSelection)return Promise.resolve();let l=this.recordType;"authority"===this.recordType&&(l="auth");const n=`open-ils.vandelay.${l}.process_spool`;return new Promise((l,e)=>{this.net.request("open-ils.vandelay",n,this.auth.token(),this.sessionKey,this.activeQueueId,null,null,this.selectedBibSource,this.sessionName||null,!0).subscribe(n=>{const u=this.evt.parse(n);if(u)return console.error(u),e();this.vandelay.pollSessionTracker(n.id()).subscribe(l=>{this.enqueueProgress.update({max:null,value:l.actions_performed()})},l=>{console.log(l),e()},()=>{this.enqueueProgress.update({max:1,value:1}),l()})})})}importRecords(){if(!this.importActionSelected())return Promise.resolve();const l=this.vandelay.importSelection;return l&&!l.importQueue?this.importRecordQueue(l.recordIds):this.importRecordQueue()}importRecordQueue(l){const n="bib"===this.recordType?"bib":"auth";let e=`open-ils.vandelay.${n}_queue.import`;const u=this.compileImportOptions();let t=this.activeQueueId;return l&&l.length&&(e=`open-ils.vandelay.${n}_record.list.import`,t=l),new Promise((l,n)=>{this.net.request("open-ils.vandelay",e,this.auth.token(),t,u).subscribe(e=>{const u=this.evt.parse(e);if(u)return console.error(u),n();this.vandelay.pollSessionTracker(e.id()).subscribe(l=>{this.importProgress.update({max:l.total_actions(),value:l.actions_performed()})},l=>{console.log(l),n()},()=>{this.importProgress.update({max:1,value:1}),l()})})})}compileImportOptions(){const l={session_key:this.sessionKey,import_no_match:this.importNonMatching,auto_overlay_exact:this.mergeOnExact,auto_overlay_best_match:this.mergeOnBestMatch,auto_overlay_1match:this.mergeOnSingleMatch,opp_acq_copy_overlay:this.autoOverlayAcqCopies,opp_oo_cat_copy_overlay:this.autoOverlayOnOrderCopies,auto_overlay_org_unit_copies:this.autoOverlayOrgUnitCopies,merge_profile:this.selectedMergeProfile,fall_through_merge_profile:this.selectedFallThruMergeProfile,strip_field_groups:this.selectedTrashGroups,match_quality_ratio:this.minQualityRatio,exit_early:!0};return this.vandelay.importSelection&&(l.overlay_map=this.vandelay.importSelection.overlayMap),l}clearSelection(){this.vandelay.importSelection=null,this.startQueueId=null}openQueue(){console.log("opening queue "+this.activeQueueId)}saveTemplate(){const l={};return Il.forEach(n=>l[n]=this[n]),console.debug("Saving import profile",l),this.formTemplates[this.selectedTemplate]=l,this.store.setItem("eg.cat.vandelay.import.templates",this.formTemplates)}markTemplateDefault(){return Object.keys(this.formTemplates).forEach(l=>delete this.formTemplates.default),this.formTemplates[this.selectedTemplate].default=!0,this.store.setItem("eg.cat.vandelay.import.templates",this.formTemplates)}templateSelectorChange(l){if(!l)return void(this.selectedTemplate="");if(this.selectedTemplate=l.label,l.freetext)return;const n=this.formTemplates[l.id];Il.forEach(l=>this[l]=n[l]),this.recordTypeSelector.applyEntryId(this.recordType),this.bibSourceSelector.applyEntryId(this.selectedBibSource),this.matchSetSelector.applyEntryId(this.selectedMatchSet),this.holdingsProfileSelector.applyEntryId(this.selectedHoldingsProfile),this.mergeProfileSelector.applyEntryId(this.selectedMergeProfile),this.fallThruMergeProfileSelector.applyEntryId(this.selectedFallThruMergeProfile)}deleteTemplate(){return delete this.formTemplates[this.selectedTemplate],this.formTemplateSelector.selected=null,this.store.setItem("eg.cat.vandelay.import.templates",this.formTemplates)}}var wl=u.ob({encapsulation:2,styles:[],data:{}});function Ml(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,6,"div",[["class","col-lg-2"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,5,"button",[["class","btn btn-info label-with-material-icon"]],null,[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,2).onClick()&&t),t}),null,null)),u.pb(2,16384,null,0,c.m,[c.l,c.a,[8,null],u.C,u.k],{routerLink:[0,"routerLink"]},null),(l()(),u.qb(3,0,null,null,1,"span",[["class","material-icons"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["arrow_back"])),(l()(),u.qb(5,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Return to Queue"]))],(function(l,n){var e=n.component;l(n,2,0,u.ub(2,"/staff/cat/vandelay/queue/",e.recordType,"/",e.selectedQueue.id,""))}),null)}function Kl(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,2,"div",[["class","row mb-3"]],null,null,null,null,null)),(l()(),u.fb(16777216,null,null,1,null,Ml)),u.pb(2,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null)],(function(l,n){l(n,2,0,n.component.selectedQueue)}),null)}function _l(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,1,"span",[["class","font-italic"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["No Groups Configured"]))],null,null)}function xl(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,3,"option",[],null,null,null,null,null)),u.pb(1,147456,null,0,_.u,[u.k,u.C,[8,null]],{value:[0,"value"]},null),u.pb(2,147456,null,0,_.F,[u.k,u.C,[2,_.A]],{value:[0,"value"]},null),(l()(),u.Kb(3,null,["",""]))],(function(l,n){var e=u.ub(1,"",n.context.$implicit.id(),"");l(n,1,0,e);var t=u.ub(1,"",n.context.$implicit.id(),"");l(n,2,0,t)}),(function(l,n){var e=n.context.$implicit.label();l(n,3,0,e)}))}function Pl(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,8,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,7,"select",[["class","form-control"],["id","marc-remove-groups"],["multiple",""],["size","3"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(l,n,e){var t=!0,a=l.component;return"change"===n&&(t=!1!==u.Cb(l,2).onChange(e.target)&&t),"blur"===n&&(t=!1!==u.Cb(l,2).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.selectedTrashGroups=e)&&t),t}),null,null)),u.pb(2,16384,null,0,_.A,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.A]),u.pb(4,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(6,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.fb(16777216,null,null,1,null,xl)),u.pb(8,278528,null,0,i.o,[u.N,u.K,u.r],{ngForOf:[0,"ngForOf"]},null)],(function(l,n){var e=n.component;l(n,4,0,e.selectedTrashGroups),l(n,8,0,e.bibTrashGroups)}),(function(l,n){l(n,1,0,u.Cb(n,6).ngClassUntouched,u.Cb(n,6).ngClassTouched,u.Cb(n,6).ngClassPristine,u.Cb(n,6).ngClassDirty,u.Cb(n,6).ngClassValid,u.Cb(n,6).ngClassInvalid,u.Cb(n,6).ngClassPending)}))}function Al(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,4,null,null,null,null,null,null,null)),(l()(),u.fb(16777216,null,null,1,null,_l)),u.pb(2,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,Pl)),u.pb(4,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(0,null,null,0))],(function(l,n){var e=n.component;l(n,2,0,0==e.bibTrashGroups.length),l(n,4,0,e.bibTrashGroups.length)}),null)}function Rl(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,5,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,1,"label",[["for","upload-file"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["File to Upload:"])),(l()(),u.qb(4,0,null,null,1,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(5,0,[[1,0],["fileSelector",1]],null,0,"input",[["class","form-control"],["id","upload-file"],["required",""],["type","file"]],null,[[null,"change"]],(function(l,n,e){var u=!0;return"change"===n&&(u=!1!==l.component.fileSelected(e)&&u),u}),null,null))],null,null)}function Nl(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.Kb(1,null,[" Importing "," Record(s)"]))],null,(function(l,n){l(n,1,0,n.component.importSelection().recordIds.length)}))}function Ol(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.Kb(1,null,[" Importing Queue ",""]))],null,(function(l,n){l(n,1,0,n.component.importSelection().queue.name())}))}function El(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,11,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,1,"label",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Import Selected"])),(l()(),u.qb(4,0,null,null,4,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.fb(16777216,null,null,1,null,Nl)),u.pb(6,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,Ol)),u.pb(8,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.qb(9,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(10,0,null,null,1,"button",[["class","btn btn-outline-info ml-2"]],null,[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==l.component.clearSelection()&&u),u}),null,null)),(l()(),u.Kb(-1,null,[" Clear Selection "]))],(function(l,n){var e=n.component;l(n,6,0,!e.importSelection().importQueue),l(n,8,0,e.importSelection().importQueue)}),null)}function Dl(l){return u.Mb(0,[u.Ib(671088640,1,{fileSelector:0}),u.Ib(402653184,2,{uploadProgress:0}),u.Ib(402653184,3,{enqueueProgress:0}),u.Ib(402653184,4,{importProgress:0}),u.Ib(402653184,5,{formTemplateSelector:0}),u.Ib(402653184,6,{recordTypeSelector:0}),u.Ib(402653184,7,{bibSourceSelector:0}),u.Ib(402653184,8,{matchSetSelector:0}),u.Ib(402653184,9,{holdingsProfileSelector:0}),u.Ib(402653184,10,{mergeProfileSelector:0}),u.Ib(402653184,11,{fallThruMergeProfileSelector:0}),u.Ib(402653184,12,{dupeQueueAlert:0}),(l()(),u.fb(16777216,null,null,1,null,Kl)),u.pb(13,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.qb(14,0,null,null,1,"eg-alert-dialog",[["dialogBody","A queue with the requested name already exists."]],null,null,null,x.b,x.a)),u.pb(15,114688,[[12,4],["dupeQueueAlert",4]],0,P.a,[A.E],{dialogBody:[0,"dialogBody"]},null),(l()(),u.qb(16,0,null,null,1,"h2",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["MARC File Upload"])),(l()(),u.qb(18,0,null,null,216,"div",[["class","common-form striped-odd form-validated ml-3 mr-3"]],null,null,null,null,null)),(l()(),u.qb(19,0,null,null,14,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(20,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(21,0,null,null,1,"label",[["for","template-select"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Apply/Create Form Template"])),(l()(),u.qb(23,0,null,null,3,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(24,0,null,null,2,"eg-combobox",[["id","template-select"],["placeholder","Apply or Create Form Template..."]],null,[[null,"onChange"]],(function(l,n,e){var u=!0;return"onChange"===n&&(u=!1!==l.component.templateSelectorChange(e)&&u),u}),R.b,R.a)),u.Hb(5120,null,_.o,(function(l){return[l]}),[N.a]),u.pb(26,114688,[[5,4],["formTemplateSelector",4]],0,N.a,[u.k,O.a,g.a,C.a],{placeholder:[0,"placeholder"],allowFreeText:[1,"allowFreeText"],startId:[2,"startId"],startIdFiresOnChange:[3,"startIdFiresOnChange"],entries:[4,"entries"]},{onChange:"onChange"}),(l()(),u.qb(27,0,null,null,6,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(28,0,null,null,1,"button",[["class","btn btn-success"]],[[8,"disabled",0]],[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==l.component.saveTemplate()&&u),u}),null,null)),(l()(),u.Kb(-1,null,["Save As New Template"])),(l()(),u.qb(30,0,null,null,1,"button",[["class","btn btn-outline-primary ml-3"]],[[8,"disabled",0]],[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==l.component.markTemplateDefault()&&u),u}),null,null)),(l()(),u.Kb(-1,null,["Mark Template as Default"])),(l()(),u.qb(32,0,null,null,1,"button",[["class","btn btn-danger ml-3"]],[[8,"disabled",0]],[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==l.component.deleteTemplate()&&u),u}),null,null)),(l()(),u.Kb(-1,null,["Delete Template"])),(l()(),u.qb(34,0,null,null,20,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(35,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(36,0,null,null,1,"label",[["for","type-select"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Record Type"])),(l()(),u.qb(38,0,null,null,9,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(39,0,null,null,8,"eg-combobox",[["id","type-select"],["placeholder","Record Type..."]],null,[[null,"onChange"]],(function(l,n,e){var u=!0;return"onChange"===n&&(u=!1!==l.component.selectEntry(e,"recordType")&&u),u}),R.b,R.a)),u.Hb(5120,null,_.o,(function(l){return[l]}),[N.a]),u.pb(41,114688,[[6,4],["recordTypeSelector",4]],0,N.a,[u.k,O.a,g.a,C.a],{placeholder:[0,"placeholder"],required:[1,"required"],disabled:[2,"disabled"],startId:[3,"startId"]},{onChange:"onChange"}),(l()(),u.qb(42,0,null,null,1,"eg-combobox-entry",[["entryId","bib"],["entryLabel","Bibliographic Records"]],null,null,null,E.b,E.a)),u.pb(43,114688,null,0,D.a,[N.a],{entryId:[0,"entryId"],entryLabel:[1,"entryLabel"]},null),(l()(),u.qb(44,0,null,null,1,"eg-combobox-entry",[["entryId","authority"],["entryLabel","Authority Records"]],null,null,null,E.b,E.a)),u.pb(45,114688,null,0,D.a,[N.a],{entryId:[0,"entryId"],entryLabel:[1,"entryLabel"]},null),(l()(),u.qb(46,0,null,null,1,"eg-combobox-entry",[["entryId","bib-acq"],["entryLabel","Acquisitions Records"]],null,null,null,E.b,E.a)),u.pb(47,114688,null,0,D.a,[N.a],{entryId:[0,"entryId"],entryLabel:[1,"entryLabel"]},null),(l()(),u.qb(48,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(49,0,null,null,1,"label",[["for","source-select"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Select a Record Source"])),(l()(),u.qb(51,0,null,null,3,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(52,0,null,null,2,"eg-combobox",[["id","source-select"],["placeholder","Record Source..."]],null,[[null,"onChange"]],(function(l,n,e){var u=!0;return"onChange"===n&&(u=!1!==l.component.selectEntry(e,"bibSources")&&u),u}),R.b,R.a)),u.Hb(5120,null,_.o,(function(l){return[l]}),[N.a]),u.pb(54,114688,[[7,4],["bibSourceSelector",4]],0,N.a,[u.k,O.a,g.a,C.a],{placeholder:[0,"placeholder"],startId:[1,"startId"],entries:[2,"entries"]},{onChange:"onChange"}),(l()(),u.qb(55,0,null,null,14,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(56,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(57,0,null,null,1,"label",[["for","queue-select"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Select or Create a Queue"])),(l()(),u.qb(59,0,null,null,3,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(60,0,null,null,2,"eg-combobox",[["id","queue-select"],["placeholder","Select or Create a Queue..."]],null,[[null,"onChange"]],(function(l,n,e){var u=!0;return"onChange"===n&&(u=!1!==(l.component.selectedQueue=e)&&u),u}),R.b,R.a)),u.Hb(5120,null,_.o,(function(l){return[l]}),[N.a]),u.pb(62,114688,null,0,N.a,[u.k,O.a,g.a,C.a],{placeholder:[0,"placeholder"],allowFreeText:[1,"allowFreeText"],required:[2,"required"],disabled:[3,"disabled"],startId:[4,"startId"],startIdFiresOnChange:[5,"startIdFiresOnChange"],entries:[6,"entries"]},{onChange:"onChange"}),(l()(),u.qb(63,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(64,0,null,null,1,"label",[["for","bucket-select"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Limit Matches to Bucket"])),(l()(),u.qb(66,0,null,null,3,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(67,0,null,null,2,"eg-combobox",[["id","bucket-select"],["placeholder","Buckets..."]],null,[[null,"onChange"]],(function(l,n,e){var u=!0;return"onChange"===n&&(u=!1!==l.component.selectEntry(e,"bibBuckets")&&u),u}),R.b,R.a)),u.Hb(5120,null,_.o,(function(l){return[l]}),[N.a]),u.pb(69,114688,null,0,N.a,[u.k,O.a,g.a,C.a],{placeholder:[0,"placeholder"],disabled:[1,"disabled"],startId:[2,"startId"],entries:[3,"entries"]},{onChange:"onChange"}),(l()(),u.qb(70,0,null,null,17,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(71,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(72,0,null,null,1,"label",[["for","match-set-select"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Record Match Set"])),(l()(),u.qb(74,0,null,null,3,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(75,0,null,null,2,"eg-combobox",[["id","match-set-select"],["placeholder","Match Set..."]],null,[[null,"onChange"]],(function(l,n,e){var u=!0;return"onChange"===n&&(u=!1!==l.component.selectEntry(e,"matchSets")&&u),u}),R.b,R.a)),u.Hb(5120,null,_.o,(function(l){return[l]}),[N.a]),u.pb(77,114688,[[8,4],["matchSetSelector",4]],0,N.a,[u.k,O.a,g.a,C.a],{placeholder:[0,"placeholder"],disabled:[1,"disabled"],startId:[2,"startId"],entries:[3,"entries"]},{onChange:"onChange"}),(l()(),u.qb(78,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(79,0,null,null,1,"label",[["for","import-non-matching"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Import Non-Matching Records"])),(l()(),u.qb(81,0,null,null,6,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(82,0,null,null,5,"input",[["class","form-check-input"],["id","import-non-matching"],["type","checkbox"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(l,n,e){var t=!0,a=l.component;return"change"===n&&(t=!1!==u.Cb(l,83).onChange(e.target.checked)&&t),"blur"===n&&(t=!1!==u.Cb(l,83).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.importNonMatching=e)&&t),t}),null,null)),u.pb(83,16384,null,0,_.b,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.b]),u.pb(85,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(87,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.qb(88,0,null,null,17,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(89,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(90,0,null,null,1,"label",[["for","item-import-def"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Holdings Import Profile"])),(l()(),u.qb(92,0,null,null,3,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(93,0,null,null,2,"eg-combobox",[["id","item-import-def"],["placeholder","Holdings Import Profile..."]],null,[[null,"onChange"]],(function(l,n,e){var u=!0;return"onChange"===n&&(u=!1!==l.component.selectEntry(e,"importItemDefs")&&u),u}),R.b,R.a)),u.Hb(5120,null,_.o,(function(l){return[l]}),[N.a]),u.pb(95,114688,[[9,4],["holdingsProfileSelector",4]],0,N.a,[u.k,O.a,g.a,C.a],{placeholder:[0,"placeholder"],disabled:[1,"disabled"],startId:[2,"startId"],entries:[3,"entries"]},{onChange:"onChange"}),(l()(),u.qb(96,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(97,0,null,null,1,"label",[["for","merge-on-exact"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Merge On Exact Match (901c)"])),(l()(),u.qb(99,0,null,null,6,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(100,0,null,null,5,"input",[["class","form-check-input"],["id","merge-on-exact"],["type","checkbox"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(l,n,e){var t=!0,a=l.component;return"change"===n&&(t=!1!==u.Cb(l,101).onChange(e.target.checked)&&t),"blur"===n&&(t=!1!==u.Cb(l,101).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.mergeOnExact=e)&&t),t}),null,null)),u.pb(101,16384,null,0,_.b,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.b]),u.pb(103,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(105,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.qb(106,0,null,null,17,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(107,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(108,0,null,null,1,"label",[["for","merge-profiles"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Merge Profile"])),(l()(),u.qb(110,0,null,null,3,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(111,0,null,null,2,"eg-combobox",[["id","merge-profiles"],["placeholder","Merge Profile..."]],null,[[null,"onChange"]],(function(l,n,e){var u=!0;return"onChange"===n&&(u=!1!==l.component.selectEntry(e,"mergeProfiles")&&u),u}),R.b,R.a)),u.Hb(5120,null,_.o,(function(l){return[l]}),[N.a]),u.pb(113,114688,[[10,4],["mergeProfileSelector",4]],0,N.a,[u.k,O.a,g.a,C.a],{placeholder:[0,"placeholder"],entries:[1,"entries"]},{onChange:"onChange"}),(l()(),u.qb(114,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(115,0,null,null,1,"label",[["for","merge-on-single"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Merge On Single Match"])),(l()(),u.qb(117,0,null,null,6,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(118,0,null,null,5,"input",[["class","form-check-input"],["id","merge-on-single"],["type","checkbox"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(l,n,e){var t=!0,a=l.component;return"change"===n&&(t=!1!==u.Cb(l,119).onChange(e.target.checked)&&t),"blur"===n&&(t=!1!==u.Cb(l,119).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.mergeOnSingleMatch=e)&&t),t}),null,null)),u.pb(119,16384,null,0,_.b,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.b]),u.pb(121,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(123,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.qb(124,0,null,null,17,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(125,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(126,0,null,null,1,"label",[["for","insuff-merge-profiles"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,[" Insufficient Quality Fall-Through Profile "])),(l()(),u.qb(128,0,null,null,3,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(129,0,null,null,2,"eg-combobox",[["id","insuff-merge-profiles"],["placeholder","Fall-Through Merge Profile..."]],null,[[null,"onChange"]],(function(l,n,e){var u=!0;return"onChange"===n&&(u=!1!==l.component.selectEntry(e,"FallThruMergeProfile")&&u),u}),R.b,R.a)),u.Hb(5120,null,_.o,(function(l){return[l]}),[N.a]),u.pb(131,114688,[[11,4],["fallThruMergeProfileSelector",4]],0,N.a,[u.k,O.a,g.a,C.a],{placeholder:[0,"placeholder"],entries:[1,"entries"]},{onChange:"onChange"}),(l()(),u.qb(132,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(133,0,null,null,1,"label",[["for","merge-on-best"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Merge On Best Match"])),(l()(),u.qb(135,0,null,null,6,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(136,0,null,null,5,"input",[["class","form-check-input"],["id","merge-on-best"],["type","checkbox"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(l,n,e){var t=!0,a=l.component;return"change"===n&&(t=!1!==u.Cb(l,137).onChange(e.target.checked)&&t),"blur"===n&&(t=!1!==u.Cb(l,137).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.mergeOnBestMatch=e)&&t),t}),null,null)),u.pb(137,16384,null,0,_.b,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.b]),u.pb(139,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(141,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.qb(142,0,null,null,21,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(143,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(144,0,null,null,1,"label",[["for","min-quality-ratio"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,[" Best/Single Match Minimum Quality Ratio "])),(l()(),u.qb(146,0,null,null,7,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(147,0,null,null,6,"input",[["class","form-control"],["id","min-quality-ratio"],["step","0.1"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],(function(l,n,e){var t=!0,a=l.component;return"input"===n&&(t=!1!==u.Cb(l,148)._handleInput(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,148).onTouched()&&t),"compositionstart"===n&&(t=!1!==u.Cb(l,148)._compositionStart()&&t),"compositionend"===n&&(t=!1!==u.Cb(l,148)._compositionEnd(e.target.value)&&t),"change"===n&&(t=!1!==u.Cb(l,149).onChange(e.target.value)&&t),"input"===n&&(t=!1!==u.Cb(l,149).onChange(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,149).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.minQualityRatio=e)&&t),t}),null,null)),u.pb(148,16384,null,0,_.d,[u.C,u.k,[2,_.a]],null,null),u.pb(149,16384,null,0,_.v,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l,n){return[l,n]}),[_.d,_.v]),u.pb(151,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(153,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.qb(154,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(155,0,null,null,1,"label",[["for","auto-overlay-acq-copies"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,[" Auto-overlay In-process Acquisitions Items "])),(l()(),u.qb(157,0,null,null,6,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(158,0,null,null,5,"input",[["class","form-check-input"],["id","auto-overlay-acq-copies"],["type","checkbox"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(l,n,e){var t=!0,a=l.component;return"change"===n&&(t=!1!==u.Cb(l,159).onChange(e.target.checked)&&t),"blur"===n&&(t=!1!==u.Cb(l,159).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.autoOverlayAcqCopies=e)&&t),t}),null,null)),u.pb(159,16384,null,0,_.b,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.b]),u.pb(161,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{isDisabled:[0,"isDisabled"],model:[1,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(163,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.qb(164,0,null,null,20,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(165,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(166,0,null,null,1,"label",[["for","session-name"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Optional Session Name:"])),(l()(),u.qb(168,0,null,null,6,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(169,0,null,null,5,"input",[["class","form-control"],["name","session-name"],["placeholder","Session Name..."],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(l,n,e){var t=!0,a=l.component;return"input"===n&&(t=!1!==u.Cb(l,170)._handleInput(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,170).onTouched()&&t),"compositionstart"===n&&(t=!1!==u.Cb(l,170)._compositionStart()&&t),"compositionend"===n&&(t=!1!==u.Cb(l,170)._compositionEnd(e.target.value)&&t),"ngModelChange"===n&&(t=!1!==(a.sessionName=e)&&t),t}),null,null)),u.pb(170,16384,null,0,_.d,[u.C,u.k,[2,_.a]],null,null),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.d]),u.pb(172,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(174,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.qb(175,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(176,0,null,null,1,"label",[["for","auto-overlay-on-order-copies"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,[" Auto-overlay On-order Cataloging Items "])),(l()(),u.qb(178,0,null,null,6,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(179,0,null,null,5,"input",[["class","form-check-input"],["id","auto-overlay-on-order-copies"],["type","checkbox"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(l,n,e){var t=!0,a=l.component;return"change"===n&&(t=!1!==u.Cb(l,180).onChange(e.target.checked)&&t),"blur"===n&&(t=!1!==u.Cb(l,180).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.autoOverlayOnOrderCopies=e)&&t),t}),null,null)),u.pb(180,16384,null,0,_.b,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.b]),u.pb(182,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{isDisabled:[0,"isDisabled"],model:[1,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(184,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.qb(185,0,null,null,15,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(186,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(187,0,null,null,1,"label",[["for","marc-remove-groups"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Remove MARC Field Groups"])),(l()(),u.fb(16777216,null,null,1,null,Al)),u.pb(190,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.qb(191,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(192,0,null,null,1,"label",[["for","auto-overlay-org-unit-copies"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,[" Use Org Unit Matching in Copy to Determine Best Match "])),(l()(),u.qb(194,0,null,null,6,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(195,0,null,null,5,"input",[["class","form-check-input"],["id","auto-overlay-org-unit-copies"],["type","checkbox"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(l,n,e){var t=!0,a=l.component;return"change"===n&&(t=!1!==u.Cb(l,196).onChange(e.target.checked)&&t),"blur"===n&&(t=!1!==u.Cb(l,196).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.autoOverlayOrgUnitCopies=e)&&t),t}),null,null)),u.pb(196,16384,null,0,_.b,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.b]),u.pb(198,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{isDisabled:[0,"isDisabled"],model:[1,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(200,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.fb(16777216,null,null,1,null,Rl)),u.pb(202,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,El)),u.pb(204,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.qb(205,0,null,null,3,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(206,0,null,null,2,"div",[["class","col-lg-6 offset-lg-3"]],null,null,null,null,null)),(l()(),u.qb(207,0,null,null,1,"button",[["class","btn btn-success btn-lg btn-block font-weight-bold"]],[[8,"disabled",0]],[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==l.component.upload()&&u),u}),null,null)),(l()(),u.Kb(-1,null,["Upload"])),(l()(),u.qb(209,0,null,null,6,"div",[["class","row"]],[[8,"hidden",0]],null,null,null,null)),(l()(),u.qb(210,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(211,0,null,null,1,"label",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Upload Progress"])),(l()(),u.qb(213,0,null,null,2,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(214,0,null,null,1,"eg-progress-inline",[],null,null,null,L.b,L.a)),u.pb(215,49152,[[2,4],["uploadProgress",4]],0,F.a,[],null,null),(l()(),u.qb(216,0,null,null,6,"div",[["class","row"]],[[8,"hidden",0]],null,null,null,null)),(l()(),u.qb(217,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(218,0,null,null,1,"label",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Enqueue Progress"])),(l()(),u.qb(220,0,null,null,2,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(221,0,null,null,1,"eg-progress-inline",[],null,null,null,L.b,L.a)),u.pb(222,49152,[[3,4],["enqueueProgress",4]],0,F.a,[],null,null),(l()(),u.qb(223,0,null,null,6,"div",[["class","row"]],[[8,"hidden",0]],null,null,null,null)),(l()(),u.qb(224,0,null,null,2,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(225,0,null,null,1,"label",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Import Progress"])),(l()(),u.qb(227,0,null,null,2,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(228,0,null,null,1,"eg-progress-inline",[],null,null,null,L.b,L.a)),u.pb(229,49152,[[4,4],["importProgress",4]],0,F.a,[],null,null),(l()(),u.qb(230,0,null,null,4,"div",[["class","row"]],[[8,"hidden",0]],null,null,null,null)),(l()(),u.qb(231,0,null,null,3,"div",[["class","col-lg-6 offset-lg-3"]],null,null,null,null,null)),(l()(),u.qb(232,0,null,null,2,"button",[["class","btn btn-info btn-lg btn-block font-weight-bold"]],null,[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,233).onClick()&&t),t}),null,null)),u.pb(233,16384,null,0,c.m,[c.l,c.a,[8,null],u.C,u.k],{routerLink:[0,"routerLink"]},null),(l()(),u.Kb(-1,null,["Go To Queue"]))],(function(l,n){var e=n.component;l(n,13,0,e.importSelection()),l(n,15,0,"A queue with the requested name already exists."),l(n,26,0,"Apply or Create Form Template...",!0,e.selectedTemplate,!0,e.formatTemplateEntries()),l(n,41,0,"Record Type...",!0,e.importSelection(),e.recordType),l(n,43,0,"bib","Bibliographic Records"),l(n,45,0,"authority","Authority Records"),l(n,47,0,"bib-acq","Acquisitions Records"),l(n,54,0,"Record Source...",e.selectedBibSource,e.formatEntries("bibSources")),l(n,62,0,"Select or Create a Queue...",!0,!0,e.startQueueId,e.startQueueId,!0,e.formatEntries("activeQueues")),l(n,69,0,"Buckets...",e.selectedQueue&&!e.selectedQueue.freetext||e.importSelection(),e.selectedBucket,e.formatEntries("bibBuckets")),l(n,77,0,"Match Set...",e.selectedQueue&&!e.selectedQueue.freetext||e.importSelection(),e.selectedMatchSet||e.defaultMatchSet,e.formatEntries("matchSets")),l(n,85,0,e.importNonMatching),l(n,95,0,"Holdings Import Profile...",e.selectedQueue&&!e.selectedQueue.freetext||e.importSelection(),e.selectedHoldingsProfile,e.formatEntries("importItemDefs")),l(n,103,0,e.mergeOnExact),l(n,113,0,"Merge Profile...",e.formatEntries("mergeProfiles")),l(n,121,0,e.mergeOnSingleMatch),l(n,131,0,"Fall-Through Merge Profile...",e.formatEntries("mergeProfiles")),l(n,139,0,e.mergeOnBestMatch),l(n,151,0,e.minQualityRatio),l(n,161,0,"authority"==e.recordType,e.autoOverlayAcqCopies),l(n,172,0,"session-name",e.sessionName),l(n,182,0,"authority"==e.recordType,e.autoOverlayOnOrderCopies),l(n,190,0,"authority"!=e.recordType),l(n,198,0,"authority"==e.recordType,e.autoOverlayOrgUnitCopies),l(n,202,0,!e.importSelection()),l(n,204,0,e.importSelection()),l(n,233,0,u.ub(2,"/staff/cat/vandelay/queue/",e.recordType,"/",e.activeQueueId,""))}),(function(l,n){var e=n.component;l(n,28,0,!e.selectedTemplate),l(n,30,0,!e.selectedTemplate),l(n,32,0,!e.selectedTemplate),l(n,82,0,u.Cb(n,87).ngClassUntouched,u.Cb(n,87).ngClassTouched,u.Cb(n,87).ngClassPristine,u.Cb(n,87).ngClassDirty,u.Cb(n,87).ngClassValid,u.Cb(n,87).ngClassInvalid,u.Cb(n,87).ngClassPending),l(n,100,0,u.Cb(n,105).ngClassUntouched,u.Cb(n,105).ngClassTouched,u.Cb(n,105).ngClassPristine,u.Cb(n,105).ngClassDirty,u.Cb(n,105).ngClassValid,u.Cb(n,105).ngClassInvalid,u.Cb(n,105).ngClassPending),l(n,118,0,u.Cb(n,123).ngClassUntouched,u.Cb(n,123).ngClassTouched,u.Cb(n,123).ngClassPristine,u.Cb(n,123).ngClassDirty,u.Cb(n,123).ngClassValid,u.Cb(n,123).ngClassInvalid,u.Cb(n,123).ngClassPending),l(n,136,0,u.Cb(n,141).ngClassUntouched,u.Cb(n,141).ngClassTouched,u.Cb(n,141).ngClassPristine,u.Cb(n,141).ngClassDirty,u.Cb(n,141).ngClassValid,u.Cb(n,141).ngClassInvalid,u.Cb(n,141).ngClassPending),l(n,147,0,u.Cb(n,153).ngClassUntouched,u.Cb(n,153).ngClassTouched,u.Cb(n,153).ngClassPristine,u.Cb(n,153).ngClassDirty,u.Cb(n,153).ngClassValid,u.Cb(n,153).ngClassInvalid,u.Cb(n,153).ngClassPending),l(n,158,0,u.Cb(n,163).ngClassUntouched,u.Cb(n,163).ngClassTouched,u.Cb(n,163).ngClassPristine,u.Cb(n,163).ngClassDirty,u.Cb(n,163).ngClassValid,u.Cb(n,163).ngClassInvalid,u.Cb(n,163).ngClassPending),l(n,169,0,u.Cb(n,174).ngClassUntouched,u.Cb(n,174).ngClassTouched,u.Cb(n,174).ngClassPristine,u.Cb(n,174).ngClassDirty,u.Cb(n,174).ngClassValid,u.Cb(n,174).ngClassInvalid,u.Cb(n,174).ngClassPending),l(n,179,0,u.Cb(n,184).ngClassUntouched,u.Cb(n,184).ngClassTouched,u.Cb(n,184).ngClassPristine,u.Cb(n,184).ngClassDirty,u.Cb(n,184).ngClassValid,u.Cb(n,184).ngClassInvalid,u.Cb(n,184).ngClassPending),l(n,195,0,u.Cb(n,200).ngClassUntouched,u.Cb(n,200).ngClassTouched,u.Cb(n,200).ngClassPristine,u.Cb(n,200).ngClassDirty,u.Cb(n,200).ngClassValid,u.Cb(n,200).ngClassInvalid,u.Cb(n,200).ngClassPending),l(n,207,0,e.isUploading||!e.hasNeededData()),l(n,209,0,!e.showProgress||e.importSelection()),l(n,216,0,!e.showProgress||e.importSelection()),l(n,223,0,!e.showProgress),l(n,230,0,!e.uploadComplete)}))}function Ll(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"ng-component",[],null,null,null,Dl,wl)),u.pb(1,4440064,null,0,Sl,[ol,Q.a,q.a,f.b,v.a,m.a,Tl.a,T],null,null)],(function(l,n){l(n,1,0)}),null)}var Fl=u.mb("ng-component",Sl,Ll,{},{},[]),Ql=e("LMfH");class Hl{constructor(l,n,e,u,t,a){this.renderer=l,this.route=n,this.http=e,this.toast=u,this.auth=t,this.basket=a,this.recordType="biblio",this.recordFormat="USMARC",this.recordEncoding="UTF-8",this.includeHoldings=!1,this.basketRecords=[]}ngOnInit(){const l=this.route.snapshot.url.length;l>0&&"basket"===this.route.snapshot.url[l-1].path&&(this.exportingBasket=!0,this.basket.getRecordIds().then(l=>this.basketRecords=l))}ngAfterViewInit(){this.exportingBasket||this.renderer.selectRootElement("#csv-input").focus()}sourceChange(l){this.recordSource=l.panelId,this.exportingBasket||l.nextState&&setTimeout(()=>{this.renderer.selectRootElement(`#${this.recordSource}-input`).focus()})}fileSelected(l){this.selectedFile=l.target.files[0]}hasNeededData(){return Boolean(this.selectedFile||this.recordId||this.bucketId||this.exportingBasket&&this.basketRecords.length>0)}exportRecords(){this.isExporting=!0,this.exportProgress.update({value:0});const l=new FormData;if(l.append("ses",this.auth.token()),l.append("rectype",this.recordType),l.append("encoding",this.recordEncoding),l.append("format",this.recordFormat),this.includeHoldings&&l.append("holdings","1"),this.exportingBasket)this.basketRecords.forEach(n=>l.append("id",""+n));else switch(this.recordSource){case"csv":l.append("idcolumn",""+this.fieldNumber),l.append("idfile",this.selectedFile,this.selectedFile.name);break;case"record-id":l.append("id",""+this.recordId);break;case"bucket-id":l.append("containerid",""+this.bucketId)}this.sendExportRequest(l)}sendExportRequest(l){const n=`export.${this.recordType}.${this.recordEncoding}.${this.recordFormat}`,e=new ll("POST","/exporter",l,{reportProgress:!0,responseType:"text"});this.http.request(e).subscribe(l=>{console.debug(l),l.type===nl.DownloadProgress?this.exportProgress.update({value:l.loaded}):l instanceof tl&&(Object(h.saveAs)(new Blob([l.body],{type:"application/octet-stream"}),n),this.isExporting=!1)},l=>{console.error(l),this.toast.danger(l.error),this.isExporting=!1})}}var Bl=u.ob({encapsulation:2,styles:[],data:{}});function Ul(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,7,null,null,null,null,null,null,null)),(l()(),u.qb(1,0,null,null,1,"div",[["class","alert alert-info"]],null,null,null,null,null)),(l()(),u.Kb(2,null,[" Exporting "," Records from Catalog Basket. "])),(l()(),u.qb(3,0,null,null,4,"div",[],null,null,null,null,null)),(l()(),u.qb(4,0,null,null,3,"a",[["queryParamsHandling","merge"],["routerLink","/staff/catalog/search"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,5).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),t}),null,null)),u.pb(5,671744,null,0,c.n,[c.l,c.a,i.m],{queryParamsHandling:[0,"queryParamsHandling"],routerLink:[1,"routerLink"]},null),(l()(),u.qb(6,0,null,null,1,"button",[["class","btn btn-info"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Return to Catalog"]))],(function(l,n){l(n,5,0,"merge","/staff/catalog/search")}),(function(l,n){l(n,2,0,n.component.basketRecords.length),l(n,4,0,u.Cb(n,5).target,u.Cb(n,5).href)}))}function jl(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,11,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,2,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,1,"label",[["for","csv-input"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Use Field Number"])),(l()(),u.qb(4,0,null,null,7,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,6,"input",[["class","form-control"],["id","csv-input"],["placeholder","Starts at 0..."],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],(function(l,n,e){var t=!0,a=l.component;return"input"===n&&(t=!1!==u.Cb(l,6)._handleInput(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,6).onTouched()&&t),"compositionstart"===n&&(t=!1!==u.Cb(l,6)._compositionStart()&&t),"compositionend"===n&&(t=!1!==u.Cb(l,6)._compositionEnd(e.target.value)&&t),"change"===n&&(t=!1!==u.Cb(l,7).onChange(e.target.value)&&t),"input"===n&&(t=!1!==u.Cb(l,7).onChange(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,7).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.fieldNumber=e)&&t),t}),null,null)),u.pb(6,16384,null,0,_.d,[u.C,u.k,[2,_.a]],null,null),u.pb(7,16384,null,0,_.v,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l,n){return[l,n]}),[_.d,_.v]),u.pb(9,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(11,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.qb(12,0,null,null,5,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(13,0,null,null,2,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(14,0,null,null,1,"label",[["for","use-csv-file"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["From CSV file"])),(l()(),u.qb(16,0,null,null,1,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(17,0,[[1,0],["fileSelector",1]],null,0,"input",[["class","form-control"],["id","use-csv-file"],["type","file"]],null,[[null,"change"]],(function(l,n,e){var u=!0;return"change"===n&&(u=!1!==l.component.fileSelected(e)&&u),u}),null,null))],(function(l,n){l(n,9,0,n.component.fieldNumber)}),(function(l,n){l(n,5,0,u.Cb(n,11).ngClassUntouched,u.Cb(n,11).ngClassTouched,u.Cb(n,11).ngClassPristine,u.Cb(n,11).ngClassDirty,u.Cb(n,11).ngClassValid,u.Cb(n,11).ngClassInvalid,u.Cb(n,11).ngClassPending)}))}function Gl(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,11,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,2,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,1,"label",[["for","record-id-input"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Record ID"])),(l()(),u.qb(4,0,null,null,7,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,6,"input",[["class","form-control"],["id","record-id-input"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],(function(l,n,e){var t=!0,a=l.component;return"input"===n&&(t=!1!==u.Cb(l,6)._handleInput(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,6).onTouched()&&t),"compositionstart"===n&&(t=!1!==u.Cb(l,6)._compositionStart()&&t),"compositionend"===n&&(t=!1!==u.Cb(l,6)._compositionEnd(e.target.value)&&t),"change"===n&&(t=!1!==u.Cb(l,7).onChange(e.target.value)&&t),"input"===n&&(t=!1!==u.Cb(l,7).onChange(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,7).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.recordId=e)&&t),t}),null,null)),u.pb(6,16384,null,0,_.d,[u.C,u.k,[2,_.a]],null,null),u.pb(7,16384,null,0,_.v,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l,n){return[l,n]}),[_.d,_.v]),u.pb(9,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(11,16384,null,0,_.q,[[4,_.p]],null,null)],(function(l,n){l(n,9,0,n.component.recordId)}),(function(l,n){l(n,5,0,u.Cb(n,11).ngClassUntouched,u.Cb(n,11).ngClassTouched,u.Cb(n,11).ngClassPristine,u.Cb(n,11).ngClassDirty,u.Cb(n,11).ngClassValid,u.Cb(n,11).ngClassInvalid,u.Cb(n,11).ngClassPending)}))}function zl(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,11,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,2,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,1,"label",[["for","bucket-id-input"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Bucket ID"])),(l()(),u.qb(4,0,null,null,7,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,6,"input",[["class","form-control"],["id","bucket-id-input"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],(function(l,n,e){var t=!0,a=l.component;return"input"===n&&(t=!1!==u.Cb(l,6)._handleInput(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,6).onTouched()&&t),"compositionstart"===n&&(t=!1!==u.Cb(l,6)._compositionStart()&&t),"compositionend"===n&&(t=!1!==u.Cb(l,6)._compositionEnd(e.target.value)&&t),"change"===n&&(t=!1!==u.Cb(l,7).onChange(e.target.value)&&t),"input"===n&&(t=!1!==u.Cb(l,7).onChange(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,7).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.bucketId=e)&&t),t}),null,null)),u.pb(6,16384,null,0,_.d,[u.C,u.k,[2,_.a]],null,null),u.pb(7,16384,null,0,_.v,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l,n){return[l,n]}),[_.d,_.v]),u.pb(9,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(11,16384,null,0,_.q,[[4,_.p]],null,null)],(function(l,n){l(n,9,0,n.component.bucketId)}),(function(l,n){l(n,5,0,u.Cb(n,11).ngClassUntouched,u.Cb(n,11).ngClassTouched,u.Cb(n,11).ngClassPristine,u.Cb(n,11).ngClassDirty,u.Cb(n,11).ngClassValid,u.Cb(n,11).ngClassInvalid,u.Cb(n,11).ngClassPending)}))}function $l(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,27,null,null,null,null,null,null,null)),(l()(),u.qb(1,0,null,null,2,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,1,"label",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Select a Record Source"])),(l()(),u.qb(4,0,null,null,23,"ngb-accordion",[["activeIds","csv"],["class","accordion"],["role","tablist"]],[[1,"aria-multiselectable",0]],[[null,"panelChange"]],(function(l,n,e){var u=!0;return"panelChange"===n&&(u=!1!==l.component.sourceChange(e)&&u),u}),r.h,r.c)),u.pb(5,2146304,null,1,A.a,[A.b],{activeIds:[0,"activeIds"],closeOtherPanels:[1,"closeOtherPanels"]},{panelChange:"panelChange"}),u.Ib(603979776,3,{panels:1}),(l()(),u.qb(7,0,null,null,6,"ngb-panel",[["id","csv"],["title","CSV File"]],null,null,null,null,null)),u.pb(8,2113536,[[3,4]],3,A.O,[],{id:[0,"id"],title:[1,"title"]},null),u.Ib(603979776,4,{titleTpls:1}),u.Ib(603979776,5,{headerTpls:1}),u.Ib(603979776,6,{contentTpls:1}),(l()(),u.fb(0,null,null,1,null,jl)),u.pb(13,16384,[[6,4]],0,A.P,[u.K],null,null),(l()(),u.qb(14,0,null,null,6,"ngb-panel",[["id","record-id"],["title","Record ID"]],null,null,null,null,null)),u.pb(15,2113536,[[3,4]],3,A.O,[],{id:[0,"id"],title:[1,"title"]},null),u.Ib(603979776,7,{titleTpls:1}),u.Ib(603979776,8,{headerTpls:1}),u.Ib(603979776,9,{contentTpls:1}),(l()(),u.fb(0,null,null,1,null,Gl)),u.pb(20,16384,[[9,4]],0,A.P,[u.K],null,null),(l()(),u.qb(21,0,null,null,6,"ngb-panel",[["id","bucket-id"],["title","Bucket"]],null,null,null,null,null)),u.pb(22,2113536,[[3,4]],3,A.O,[],{id:[0,"id"],title:[1,"title"]},null),u.Ib(603979776,10,{titleTpls:1}),u.Ib(603979776,11,{headerTpls:1}),u.Ib(603979776,12,{contentTpls:1}),(l()(),u.fb(0,null,null,1,null,zl)),u.pb(27,16384,[[12,4]],0,A.P,[u.K],null,null)],(function(l,n){l(n,5,0,"csv",!0),l(n,8,0,"csv","CSV File"),l(n,15,0,"record-id","Record ID"),l(n,22,0,"bucket-id","Bucket")}),(function(l,n){l(n,4,0,!u.Cb(n,5).closeOtherPanels)}))}function Vl(l){return u.Mb(0,[u.Ib(671088640,1,{fileSelector:0}),u.Ib(402653184,2,{exportProgress:0}),(l()(),u.qb(2,0,null,null,1,"h2",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Export Records"])),(l()(),u.qb(4,0,null,null,91,"div",[["class","common-form striped-even form-validated"]],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,90,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(6,0,null,null,4,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.fb(16777216,null,null,1,null,Ul)),u.pb(8,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,$l)),u.pb(10,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.qb(11,0,null,null,84,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(12,0,null,null,18,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(13,0,null,null,2,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(14,0,null,null,1,"label",[["for","record-type"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Record Type"])),(l()(),u.qb(16,0,null,null,14,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(17,0,null,null,13,"select",[["class","form-control"],["id","record-type"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(l,n,e){var t=!0,a=l.component;return"change"===n&&(t=!1!==u.Cb(l,18).onChange(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,18).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.recordType=e)&&t),t}),null,null)),u.pb(18,16384,null,0,_.z,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.z]),u.pb(20,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{isDisabled:[0,"isDisabled"],model:[1,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(22,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.qb(23,0,null,null,3,"option",[["value","biblio"]],null,null,null,null,null)),u.pb(24,147456,null,0,_.u,[u.k,u.C,[2,_.z]],{value:[0,"value"]},null),u.pb(25,147456,null,0,_.F,[u.k,u.C,[8,null]],{value:[0,"value"]},null),(l()(),u.Kb(-1,null,["Bibliographic Records"])),(l()(),u.qb(27,0,null,null,3,"option",[["value","authority"]],null,null,null,null,null)),u.pb(28,147456,null,0,_.u,[u.k,u.C,[2,_.z]],{value:[0,"value"]},null),u.pb(29,147456,null,0,_.F,[u.k,u.C,[8,null]],{value:[0,"value"]},null),(l()(),u.Kb(-1,null,["Authority Records"])),(l()(),u.qb(31,0,null,null,26,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(32,0,null,null,2,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(33,0,null,null,1,"label",[["for","record-format"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Record Format"])),(l()(),u.qb(35,0,null,null,22,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(36,0,null,null,21,"select",[["class","form-control"],["id","record-format"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(l,n,e){var t=!0,a=l.component;return"change"===n&&(t=!1!==u.Cb(l,37).onChange(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,37).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.recordFormat=e)&&t),t}),null,null)),u.pb(37,16384,null,0,_.z,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.z]),u.pb(39,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(41,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.qb(42,0,null,null,3,"option",[["value","USMARC"]],null,null,null,null,null)),u.pb(43,147456,null,0,_.u,[u.k,u.C,[2,_.z]],{value:[0,"value"]},null),u.pb(44,147456,null,0,_.F,[u.k,u.C,[8,null]],{value:[0,"value"]},null),(l()(),u.Kb(-1,null,["MARC21"])),(l()(),u.qb(46,0,null,null,3,"option",[["value","UNIMARC"]],null,null,null,null,null)),u.pb(47,147456,null,0,_.u,[u.k,u.C,[2,_.z]],{value:[0,"value"]},null),u.pb(48,147456,null,0,_.F,[u.k,u.C,[8,null]],{value:[0,"value"]},null),(l()(),u.Kb(-1,null,["UNIMARC"])),(l()(),u.qb(50,0,null,null,3,"option",[["value","XML"]],null,null,null,null,null)),u.pb(51,147456,null,0,_.u,[u.k,u.C,[2,_.z]],{value:[0,"value"]},null),u.pb(52,147456,null,0,_.F,[u.k,u.C,[8,null]],{value:[0,"value"]},null),(l()(),u.Kb(-1,null,["MARC XML"])),(l()(),u.qb(54,0,null,null,3,"option",[["value","BRE"]],null,null,null,null,null)),u.pb(55,147456,null,0,_.u,[u.k,u.C,[2,_.z]],{value:[0,"value"]},null),u.pb(56,147456,null,0,_.F,[u.k,u.C,[8,null]],{value:[0,"value"]},null),(l()(),u.Kb(-1,null,["Evergreen Record Entry"])),(l()(),u.qb(58,0,null,null,18,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(59,0,null,null,2,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(60,0,null,null,1,"label",[["for","record-encoding"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Record Encoding"])),(l()(),u.qb(62,0,null,null,14,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(63,0,null,null,13,"select",[["class","form-control"],["id","record-encoding"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(l,n,e){var t=!0,a=l.component;return"change"===n&&(t=!1!==u.Cb(l,64).onChange(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,64).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.recordEncoding=e)&&t),t}),null,null)),u.pb(64,16384,null,0,_.z,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.z]),u.pb(66,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(68,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.qb(69,0,null,null,3,"option",[["value","UTF-8"]],null,null,null,null,null)),u.pb(70,147456,null,0,_.u,[u.k,u.C,[2,_.z]],{value:[0,"value"]},null),u.pb(71,147456,null,0,_.F,[u.k,u.C,[8,null]],{value:[0,"value"]},null),(l()(),u.Kb(-1,null,["UTF-8"])),(l()(),u.qb(73,0,null,null,3,"option",[["value","MARC8"]],null,null,null,null,null)),u.pb(74,147456,null,0,_.u,[u.k,u.C,[2,_.z]],{value:[0,"value"]},null),u.pb(75,147456,null,0,_.F,[u.k,u.C,[8,null]],{value:[0,"value"]},null),(l()(),u.Kb(-1,null,["MARC8"])),(l()(),u.qb(77,0,null,null,10,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(78,0,null,null,2,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(79,0,null,null,1,"label",[["for","include-holdings"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,[" Include holdings in Bibliographic Records "])),(l()(),u.qb(81,0,null,null,6,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(82,0,null,null,5,"input",[["class","form-check-input"],["id","include-holdings"],["type","checkbox"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(l,n,e){var t=!0,a=l.component;return"change"===n&&(t=!1!==u.Cb(l,83).onChange(e.target.checked)&&t),"blur"===n&&(t=!1!==u.Cb(l,83).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.includeHoldings=e)&&t),t}),null,null)),u.pb(83,16384,null,0,_.b,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.b]),u.pb(85,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(87,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.qb(88,0,null,null,3,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(89,0,null,null,2,"div",[["class","col-lg-10 offset-lg-1"]],null,null,null,null,null)),(l()(),u.qb(90,0,null,null,1,"button",[["class","btn btn-success btn-lg btn-block font-weight-bold"]],[[8,"disabled",0]],[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==l.component.exportRecords()&&u),u}),null,null)),(l()(),u.Kb(-1,null,["Export"])),(l()(),u.qb(92,0,null,null,3,"div",[["class","row"]],[[8,"hidden",0]],null,null,null,null)),(l()(),u.qb(93,0,null,null,2,"div",[["class","col-lg-10 offset-lg-1"]],null,null,null,null,null)),(l()(),u.qb(94,0,null,null,1,"eg-progress-inline",[],null,null,null,L.b,L.a)),u.pb(95,49152,[[2,4],["exportProgress",4]],0,F.a,[],null,null)],(function(l,n){var e=n.component;l(n,8,0,e.exportingBasket),l(n,10,0,!e.exportingBasket),l(n,20,0,e.exportingBasket,e.recordType),l(n,24,0,"biblio"),l(n,25,0,"biblio"),l(n,28,0,"authority"),l(n,29,0,"authority"),l(n,39,0,e.recordFormat),l(n,43,0,"USMARC"),l(n,44,0,"USMARC"),l(n,47,0,"UNIMARC"),l(n,48,0,"UNIMARC"),l(n,51,0,"XML"),l(n,52,0,"XML"),l(n,55,0,"BRE"),l(n,56,0,"BRE"),l(n,66,0,e.recordEncoding),l(n,70,0,"UTF-8"),l(n,71,0,"UTF-8"),l(n,74,0,"MARC8"),l(n,75,0,"MARC8"),l(n,85,0,e.includeHoldings)}),(function(l,n){var e=n.component;l(n,17,0,u.Cb(n,22).ngClassUntouched,u.Cb(n,22).ngClassTouched,u.Cb(n,22).ngClassPristine,u.Cb(n,22).ngClassDirty,u.Cb(n,22).ngClassValid,u.Cb(n,22).ngClassInvalid,u.Cb(n,22).ngClassPending),l(n,36,0,u.Cb(n,41).ngClassUntouched,u.Cb(n,41).ngClassTouched,u.Cb(n,41).ngClassPristine,u.Cb(n,41).ngClassDirty,u.Cb(n,41).ngClassValid,u.Cb(n,41).ngClassInvalid,u.Cb(n,41).ngClassPending),l(n,63,0,u.Cb(n,68).ngClassUntouched,u.Cb(n,68).ngClassTouched,u.Cb(n,68).ngClassPristine,u.Cb(n,68).ngClassDirty,u.Cb(n,68).ngClassValid,u.Cb(n,68).ngClassInvalid,u.Cb(n,68).ngClassPending),l(n,82,0,u.Cb(n,87).ngClassUntouched,u.Cb(n,87).ngClassTouched,u.Cb(n,87).ngClassPristine,u.Cb(n,87).ngClassDirty,u.Cb(n,87).ngClassValid,u.Cb(n,87).ngClassInvalid,u.Cb(n,87).ngClassPending),l(n,90,0,e.isExporting||!e.hasNeededData()),l(n,92,0,!e.isExporting)}))}function Xl(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"ng-component",[],null,null,null,Vl,Bl)),u.pb(1,4308992,null,0,Hl,[u.C,c.a,ol,Q.a,v.a,Ql.a],null,null)],(function(l,n){l(n,1,0)}),null)}var Jl=u.mb("ng-component",Hl,Xl,{},{},[]),Wl=e("Qm07"),Zl=e("9Zsr"),Yl=e("ZvpF"),ln=e("y+3C"),nn=e("QGNW"),en=e("MWGh");class un{constructor(l,n,e,u,t){this.router=l,this.route=n,this.net=e,this.auth=u,this.vandelay=t,this.queueType="bib",this.queueSource=new en.c,this.vandelay.queuePageOffset=0,this.queueSource.getRows=l=>this.loadQueues(l),this.deleteSelected=l=>{const n=`open-ils.vandelay.${this.queueType}_queue.delete`,e=l.slice(0),u=l=>{const t=e[l];return t?this.net.request("open-ils.vandelay",n,this.auth.token(),t.id()).toPromise().then(()=>u(++l)):(this.currentGrid().reload(),Promise.resolve())};u(0)}}currentGrid(){return this.bibQueueGrid||this.authQueueGrid}rowActivated(l){const n=`/staff/cat/vandelay/queue/${this.queueType}/${l.id()}`;this.router.navigate([n])}queueTypeChanged(l){this.queueType=l.id,this.queueSource.reset()}loadQueues(l){if(!this.queueType)return Object(H.a)();const n=this.queueType.match(/bib/)?"bib":"authority";return this.net.request("open-ils.vandelay",`open-ils.vandelay.${n}_queue.owner.retrieve`,this.auth.token(),null,null,{offset:l.offset,limit:l.limit})}}var tn=u.ob({encapsulation:2,styles:[],data:{}});function an(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,3,"eg-grid",[["idlClass","vbq"],["persistKey","cat.vandelay.queue.list.bib"]],null,[[null,"onRowActivate"]],(function(l,n,e){var u=!0;return"onRowActivate"===n&&(u=!1!==l.component.rowActivated(e)&&u),u}),Wl.b,Wl.a)),u.pb(1,4440064,[[1,4],["bibQueueGrid",4]],0,Zl.a,[g.a,m.a,Tl.a,Yl.a],{dataSource:[0,"dataSource"],idlClass:[1,"idlClass"],persistKey:[2,"persistKey"]},{onRowActivate:"onRowActivate"}),(l()(),u.qb(2,0,null,null,1,"eg-grid-toolbar-action",[["label","Delete Selected"]],null,null,null,ln.b,ln.a)),u.pb(3,114688,null,0,nn.a,[Zl.a],{label:[0,"label"],action:[1,"action"]},null)],(function(l,n){var e=n.component;l(n,1,0,e.queueSource,"vbq","cat.vandelay.queue.list.bib"),l(n,3,0,"Delete Selected",e.deleteSelected)}),null)}function rn(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,3,"eg-grid",[["idlClass","vaq"],["persistKey","cat.vandelay.queue.list.auth"]],null,[[null,"onRowActivate"]],(function(l,n,e){var u=!0;return"onRowActivate"===n&&(u=!1!==l.component.rowActivated(e)&&u),u}),Wl.b,Wl.a)),u.pb(1,4440064,[[2,4],["authQueueGrid",4]],0,Zl.a,[g.a,m.a,Tl.a,Yl.a],{dataSource:[0,"dataSource"],idlClass:[1,"idlClass"],persistKey:[2,"persistKey"]},{onRowActivate:"onRowActivate"}),(l()(),u.qb(2,0,null,null,1,"eg-grid-toolbar-action",[["label","Delete Selected"]],null,null,null,ln.b,ln.a)),u.pb(3,114688,null,0,nn.a,[Zl.a],{label:[0,"label"],action:[1,"action"]},null)],(function(l,n){var e=n.component;l(n,1,0,e.queueSource,"vaq","cat.vandelay.queue.list.auth"),l(n,3,0,"Delete Selected",e.deleteSelected)}),null)}function on(l){return u.Mb(0,[u.Ib(671088640,1,{bibQueueGrid:0}),u.Ib(671088640,2,{authQueueGrid:0}),(l()(),u.qb(2,0,null,null,16,"div",[["class","import-form"]],null,null,null,null,null)),(l()(),u.qb(3,0,null,null,1,"h2",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Select a Queue To Inspect"])),(l()(),u.qb(5,0,null,null,13,"div",[["class","row flex"]],null,null,null,null,null)),(l()(),u.qb(6,0,null,null,2,"div",[],null,null,null,null,null)),(l()(),u.qb(7,0,null,null,1,"label",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Queue Type"])),(l()(),u.qb(9,0,null,null,9,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.qb(10,0,null,null,8,"eg-combobox",[["placeholder","Queue Type..."]],null,[[null,"onChange"]],(function(l,n,e){var u=!0;return"onChange"===n&&(u=!1!==l.component.queueTypeChanged(e)&&u),u}),R.b,R.a)),u.Hb(5120,null,_.o,(function(l){return[l]}),[N.a]),u.pb(12,114688,null,0,N.a,[u.k,O.a,g.a,C.a],{placeholder:[0,"placeholder"],startId:[1,"startId"]},{onChange:"onChange"}),(l()(),u.qb(13,0,null,null,1,"eg-combobox-entry",[["entryId","bib"],["entryLabel","Bibliographic Records"]],null,null,null,E.b,E.a)),u.pb(14,114688,null,0,D.a,[N.a],{entryId:[0,"entryId"],entryLabel:[1,"entryLabel"]},null),(l()(),u.qb(15,0,null,null,1,"eg-combobox-entry",[["entryId","auth"],["entryLabel","Authority Records"]],null,null,null,E.b,E.a)),u.pb(16,114688,null,0,D.a,[N.a],{entryId:[0,"entryId"],entryLabel:[1,"entryLabel"]},null),(l()(),u.qb(17,0,null,null,1,"eg-combobox-entry",[["entryId","bib-acq"],["entryLabel","Acquisitions Records"]],null,null,null,E.b,E.a)),u.pb(18,114688,null,0,D.a,[N.a],{entryId:[0,"entryId"],entryLabel:[1,"entryLabel"]},null),(l()(),u.fb(16777216,null,null,1,null,an)),u.pb(20,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,rn)),u.pb(22,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null)],(function(l,n){var e=n.component;l(n,12,0,"Queue Type...",e.queueType),l(n,14,0,"bib","Bibliographic Records"),l(n,16,0,"auth","Authority Records"),l(n,18,0,"bib-acq","Acquisitions Records"),l(n,20,0,"bib"==e.queueType),l(n,22,0,"auth"==e.queueType)}),null)}function sn(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"ng-component",[],null,null,null,on,tn)),u.pb(1,49152,null,0,un,[c.l,c.a,f.b,v.a,T],null,null)],null,null)}var cn=u.mb("ng-component",un,sn,{},{},[]),bn=e("6rhm"),dn=e("36iw"),pn=e("1qTD"),hn=e("1tmW"),gn=e("Ghns"),mn=e("KBUj"),fn=e("GlUJ"),vn=e("gtj8"),Cn=e("DwFa"),yn=e("t7hH");class qn{constructor(l,n,e,u,t,a){this.router=l,this.route=n,this.evt=e,this.net=u,this.auth=t,this.vandelay=a,this.filters={matches:!1,nonImported:!1,withErrors:!1},this.route.paramMap.subscribe(l=>{this.queueType=l.get("qtype"),this.queueId=+l.get("id")}),this.queueSource=new en.c,this.queueSource.getRows=l=>(this.vandelay.queuePageOffset=l.offset,this.loadQueueRecords(l)),this.cellTextGenerator={"+matches":l=>l.matches.length+"",import_error:l=>null==l.import_error?"":l.import_error,imported_as:l=>l.imported_as+""}}ngOnInit(){}limitToMatches(l){this.filters.matches=l,this.queueGrid.reload()}limitToNonImported(l){this.filters.nonImported=l,this.queueGrid.reload()}limitToImportErrors(l){this.filters.withErrors=l,this.queueGrid.reload()}queuePageOffset(){return this.vandelay.queuePageOffset}ngAfterViewInit(){this.queueType&&(this.applyQueueType(),this.queueId&&this.loadQueueSummary())}openRecord(l){"auth"===this.queueType&&(this.queueType="authority"),this.router.navigate([`/staff/cat/vandelay/queue/${this.queueType}/${this.queueId}/record/${l.id}/marc`])}applyQueueType(){this.queuedRecClass=this.queueType.match(/bib/)?"vqbr":"vqar",this.vandelay.getAttrDefs(this.queueType).then(l=>{this.attrDefs=l,l.forEach(l=>{const n=new en.a;n.name=l.code(),n.label=l.description(),n.datatype="string",this.queueGrid.context.columnSet.add(n)}),this.queueGrid.context.applyGridConfig()})}qtypeShort(){return"bib"===this.queueType?"bib":"auth"}loadQueueSummary(){const l=`open-ils.vandelay.${this.qtypeShort()}_queue.summary.retrieve`;return this.net.request("open-ils.vandelay",l,this.auth.token(),this.queueId).toPromise().then(l=>this.queueSummary=l)}loadQueueRecords(l){return this.vandelay.getQueuedRecords(this.queueId,this.queueType,{clear_marc:!0,offset:l.offset,limit:l.limit,flesh_import_items:!0,non_imported:this.filters.nonImported,with_import_error:this.filters.withErrors},this.filters.matches).pipe(Object(U.a)(l=>{const n=this.evt.parse(l);return!n||(console.error(n),!1)}),Object(j.a)(l=>{const n={id:l.id(),import_error:l.import_error(),error_detail:l.error_detail(),import_time:l.import_time(),imported_as:l.imported_as(),import_items:[],error_items:[],matches:l.matches()};return"bib"===this.queueType&&(n.import_items=l.import_items(),n.error_items=l.import_items().filter(l=>l.import_error())),l.attributes().forEach(l=>{const e=this.attrDefs.filter(n=>n.id()===l.field())[0];n[e.code()]=l.attr_value()}),n}))}findOrCreateImportSelection(){let l=this.vandelay.importSelection;return l||(l=new k,this.vandelay.importSelection=l),l.queue=this.queueSummary.queue,l}hasOverlayTarget(l){return this.vandelay.importSelection&&Boolean(this.vandelay.importSelection.overlayMap[l])}importSelected(){const l=this.queueGrid.context.getSelectedRows();l.length&&(this.findOrCreateImportSelection().recordIds=l.map(l=>l.id),console.log("importing: ",this.vandelay.importSelection),this.router.navigate(["/staff/cat/vandelay/import"]))}importAll(){this.findOrCreateImportSelection().importQueue=!0,this.router.navigate(["/staff/cat/vandelay/import"])}deleteQueue(){this.confirmDelDlg.open().subscribe(l=>{l&&(this.progressDlg.open(),this.net.request("open-ils.vandelay",`open-ils.vandelay.${this.qtypeShort()}_queue.delete`,this.auth.token(),this.queueId).toPromise().then(l=>{const n=this.evt.parse(l);if(n)return new Error(n.toString());this.router.navigate(["/staff/cat/vandelay/queue"])},l=>console.error("queue deletion failed!",l)).finally(()=>this.progressDlg.close()))})}exportNonImported(){this.vandelay.exportQueue(this.queueSummary.queue,!0)}}var kn=u.ob({encapsulation:2,styles:[],data:{}});function Tn(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,77,null,null,null,null,null,null,null)),(l()(),u.qb(1,0,null,null,1,"eg-confirm-dialog",[["dialogTitle","Confirm Delete"]],null,null,null,bn.b,bn.a)),u.pb(2,114688,[[2,4],["confirmDelDlg",4]],0,dn.a,[A.E],{dialogTitle:[0,"dialogTitle"],dialogBody:[1,"dialogBody"]},null),(l()(),u.qb(3,0,null,null,1,"h2",[],null,null,null,null,null)),(l()(),u.Kb(4,null,["Queue ",""])),(l()(),u.qb(5,0,null,null,72,"div",[["class","row pb-2"]],null,null,null,null,null)),(l()(),u.qb(6,0,null,null,34,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(7,0,null,null,33,"div",[["class","card tight-card"]],null,null,null,null,null)),(l()(),u.qb(8,0,null,null,1,"h5",[["class","card-header"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Queue Summary"])),(l()(),u.qb(10,0,null,null,30,"ul",[["class","list-group list-group-flush"]],null,null,null,null,null)),(l()(),u.qb(11,0,null,null,9,"li",[["class","list-group-item"]],null,null,null,null,null)),(l()(),u.qb(12,0,null,null,8,"div",[["class","d-flex"]],null,null,null,null,null)),(l()(),u.qb(13,0,null,null,1,"div",[["class","flex-3"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Records in Queue:"])),(l()(),u.qb(15,0,null,null,1,"div",[["class","flex-1"]],null,null,null,null,null)),(l()(),u.Kb(16,null,["",""])),(l()(),u.qb(17,0,null,null,1,"div",[["class","flex-3"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Items in Queue:"])),(l()(),u.qb(19,0,null,null,1,"div",[["class","flex-1"]],null,null,null,null,null)),(l()(),u.Kb(20,null,["",""])),(l()(),u.qb(21,0,null,null,9,"li",[["class","list-group-item"]],null,null,null,null,null)),(l()(),u.qb(22,0,null,null,8,"div",[["class","d-flex"]],null,null,null,null,null)),(l()(),u.qb(23,0,null,null,1,"div",[["class","flex-3"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Records Imported:"])),(l()(),u.qb(25,0,null,null,1,"div",[["class","flex-1"]],null,null,null,null,null)),(l()(),u.Kb(26,null,["",""])),(l()(),u.qb(27,0,null,null,1,"div",[["class","flex-3"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Items Imported:"])),(l()(),u.qb(29,0,null,null,1,"div",[["class","flex-1"]],null,null,null,null,null)),(l()(),u.Kb(30,null,["",""])),(l()(),u.qb(31,0,null,null,9,"li",[["class","list-group-item"]],null,null,null,null,null)),(l()(),u.qb(32,0,null,null,8,"div",[["class","d-flex"]],null,null,null,null,null)),(l()(),u.qb(33,0,null,null,1,"div",[["class","flex-3"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Records Import Failures:"])),(l()(),u.qb(35,0,null,null,1,"div",[["class","flex-1"]],null,null,null,null,null)),(l()(),u.Kb(36,null,["",""])),(l()(),u.qb(37,0,null,null,1,"div",[["class","flex-3"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Item Import Failures:"])),(l()(),u.qb(39,0,null,null,1,"div",[["class","flex-1"]],null,null,null,null,null)),(l()(),u.Kb(40,null,["",""])),(l()(),u.qb(41,0,null,null,36,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(42,0,null,null,35,"div",[["class","card tight-card"]],null,null,null,null,null)),(l()(),u.qb(43,0,null,null,1,"h5",[["class","card-header"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Queue Actions"])),(l()(),u.qb(45,0,null,null,32,"ul",[["class","list-group list-group-flush"]],null,null,null,null,null)),(l()(),u.qb(46,0,null,null,9,"li",[["class","list-group-item"]],null,null,null,null,null)),(l()(),u.qb(47,0,null,null,8,"div",[["class","d-flex"]],null,null,null,null,null)),(l()(),u.qb(48,0,null,null,3,"div",[["class","flex-1"]],null,null,null,null,null)),(l()(),u.qb(49,0,null,null,2,"a",[],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0,a=l.component;return"click"===n&&(t=!1!==u.Cb(l,50).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),"click"===n&&(t=!1!==a.importSelected()&&t),t}),null,null)),u.pb(50,671744,null,0,c.n,[c.l,c.a,i.m],null,null),(l()(),u.Kb(-1,null,["Import Selected Records"])),(l()(),u.qb(52,0,null,null,3,"div",[["class","flex-1"]],null,null,null,null,null)),(l()(),u.qb(53,0,null,null,2,"a",[],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0,a=l.component;return"click"===n&&(t=!1!==u.Cb(l,54).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),"click"===n&&(t=!1!==a.importAll()&&t),t}),null,null)),u.pb(54,671744,null,0,c.n,[c.l,c.a,i.m],null,null),(l()(),u.Kb(-1,null,["Import All Records"])),(l()(),u.qb(56,0,null,null,9,"li",[["class","list-group-item"]],null,null,null,null,null)),(l()(),u.qb(57,0,null,null,8,"div",[["class","d-flex"]],null,null,null,null,null)),(l()(),u.qb(58,0,null,null,3,"div",[["class","flex-1"]],null,null,null,null,null)),(l()(),u.qb(59,0,null,null,2,"a",[],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,60).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),t}),null,null)),u.pb(60,671744,null,0,c.n,[c.l,c.a,i.m],{routerLink:[0,"routerLink"]},null),(l()(),u.Kb(-1,null,[" View Import Items "])),(l()(),u.qb(62,0,null,null,3,"div",[["class","flex-1"]],null,null,null,null,null)),(l()(),u.qb(63,0,null,null,2,"a",[],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0,a=l.component;return"click"===n&&(t=!1!==u.Cb(l,64).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),"click"===n&&(t=!1!==a.exportNonImported()&&t),t}),null,null)),u.pb(64,671744,null,0,c.n,[c.l,c.a,i.m],null,null),(l()(),u.Kb(-1,null,["Export Non-Imported Records"])),(l()(),u.qb(66,0,null,null,11,"li",[["class","list-group-item"]],null,null,null,null,null)),(l()(),u.qb(67,0,null,null,10,"div",[["class","d-flex"]],null,null,null,null,null)),(l()(),u.qb(68,0,null,null,1,"eg-bucket-dialog",[["bucketClass","biblio"]],null,null,null,pn.b,pn.a)),u.pb(69,114688,[["bucketDialog",4]],0,hn.a,[A.E,u.C,Q.a,g.a,f.b,q.a,v.a],{bucketClass:[0,"bucketClass"],fromBibQueue:[1,"fromBibQueue"]},null),(l()(),u.qb(70,0,null,null,3,"div",[["class","flex-1"]],null,null,null,null,null)),(l()(),u.qb(71,0,null,null,2,"a",[],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,72).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),"click"===n&&(t=!1!==u.Cb(l,69).open({size:"lg"})&&t),t}),null,null)),u.pb(72,671744,null,0,c.n,[c.l,c.a,i.m],null,null),(l()(),u.Kb(-1,null,[" Copy Queue To Bucket "])),(l()(),u.qb(74,0,null,null,3,"div",[["class","flex-1"]],null,null,null,null,null)),(l()(),u.qb(75,0,null,null,2,"a",[],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0,a=l.component;return"click"===n&&(t=!1!==u.Cb(l,76).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),"click"===n&&(t=!1!==a.deleteQueue()&&t),t}),null,null)),u.pb(76,671744,null,0,c.n,[c.l,c.a,i.m],null,null),(l()(),u.Kb(-1,null,["Delete Queue"]))],(function(l,n){var e=n.component;l(n,2,0,"Confirm Delete",u.ub(1,"Delete Queue ",e.queueSummary.queue.name(),"?")),l(n,60,0,u.ub(2,"/staff/cat/vandelay/queue/",e.queueType,"/",e.queueId,"/items")),l(n,69,0,"biblio",e.queueId)}),(function(l,n){var e=n.component;l(n,4,0,e.queueSummary.queue.name()),l(n,16,0,e.queueSummary.total),l(n,20,0,e.queueSummary.total_items),l(n,26,0,e.queueSummary.imported),l(n,30,0,e.queueSummary.total_items_imported),l(n,36,0,e.queueSummary.rec_import_errors),l(n,40,0,e.queueSummary.item_import_errors),l(n,49,0,u.Cb(n,50).target,u.Cb(n,50).href),l(n,53,0,u.Cb(n,54).target,u.Cb(n,54).href),l(n,59,0,u.Cb(n,60).target,u.Cb(n,60).href),l(n,63,0,u.Cb(n,64).target,u.Cb(n,64).href),l(n,71,0,u.Cb(n,72).target,u.Cb(n,72).href),l(n,75,0,u.Cb(n,76).target,u.Cb(n,76).href)}))}function In(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,5,"a",[],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,4).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),t}),null,null)),u.Hb(512,null,i.N,i.O,[u.r,u.s,u.k,u.C]),u.pb(2,278528,null,0,i.n,[i.N],{ngClass:[0,"ngClass"]},null),u.Fb(3,{"font-weight-bold":0}),u.pb(4,671744,null,0,c.n,[c.l,c.a,i.m],{routerLink:[0,"routerLink"]},null),(l()(),u.Kb(5,null,[" (",") "," "]))],(function(l,n){var e=n.component,t=l(n,3,0,e.hasOverlayTarget(n.context.row.id));l(n,2,0,t),l(n,4,0,u.ub(3,"/staff/cat/vandelay/queue/",e.queueType,"/",e.queueId,"/record/",n.context.row.id,"/matches"))}),(function(l,n){var e=n.component;l(n,0,0,u.Cb(n,4).target,u.Cb(n,4).href),l(n,5,0,n.context.row.matches.length,e.hasOverlayTarget(n.context.row.id)?"*":"")}))}function Sn(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,2,"div",[],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,1,"b",[["class","text-danger"]],[[8,"title",0]],null,null,null,null)),(l()(),u.Kb(2,null,["",""]))],null,(function(l,n){l(n,1,0,u.ub(1,"",n.parent.context.row.error_detail,"")),l(n,2,0,n.parent.context.row.import_error)}))}function wn(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,2,"div",[],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,1,"b",[["class","text-danger"]],null,null,null,null,null)),(l()(),u.Kb(2,null,["Items (",")"]))],null,(function(l,n){l(n,2,0,n.parent.context.row.error_items.length)}))}function Mn(l){return u.Mb(0,[(l()(),u.fb(16777216,null,null,1,null,Sn)),u.pb(1,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,wn)),u.pb(3,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(0,null,null,0))],(function(l,n){l(n,1,0,n.context.row.error_detail),l(n,3,0,n.context.row.error_items.length)}),null)}function Kn(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,2,"a",[],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,1).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),t}),null,null)),u.pb(1,671744,null,0,c.n,[c.l,c.a,i.m],{routerLink:[0,"routerLink"]},null),(l()(),u.Kb(2,null,[" "," "]))],(function(l,n){l(n,1,0,u.ub(1,"/staff/catalog/record/",n.parent.context.row.imported_as,""))}),(function(l,n){l(n,0,0,u.Cb(n,1).target,u.Cb(n,1).href),l(n,2,0,n.parent.context.row.imported_as)}))}function _n(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"a",[],[[8,"href",4]],null,null,null,null)),(l()(),u.Kb(1,null,[" "," "]))],null,(function(l,n){l(n,0,0,u.ub(1,"/eg/staff/cat/catalog/authority/",n.parent.context.row.imported_as,"/marc_edit")),l(n,1,0,n.parent.context.row.imported_as)}))}function xn(l){return u.Mb(0,[(l()(),u.fb(16777216,null,null,1,null,Kn)),u.pb(1,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,_n)),u.pb(3,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(0,null,null,0))],(function(l,n){var e=n.component;l(n,1,0,"bib"==e.queueType),l(n,3,0,"auth"==e.queueType)}),null)}function Pn(l){return u.Mb(0,[u.Ib(402653184,1,{queueGrid:0}),u.Ib(671088640,2,{confirmDelDlg:0}),u.Ib(402653184,3,{progressDlg:0}),(l()(),u.qb(3,0,null,null,1,"eg-progress-dialog",[["dialogTitle","Deleting Queue..."]],null,null,null,gn.b,gn.a)),u.pb(4,114688,[[3,4],["progressDlg",4]],0,mn.a,[A.E],{dialogTitle:[0,"dialogTitle"]},null),(l()(),u.fb(16777216,null,null,1,null,Tn)),u.pb(6,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(0,[["matchesTmpl",2]],null,0,null,In)),(l()(),u.fb(0,[["errorsTmpl",2]],null,0,null,Mn)),(l()(),u.fb(0,[["importedAsTmpl",2]],null,0,null,xn)),(l()(),u.qb(10,0,null,null,17,"eg-grid",[["hideFields","language,pagination,price,rec_identifier,eg_tcn_source,eg_identifier,item_barcode,zsource"]],null,[[null,"onRowActivate"]],(function(l,n,e){var u=!0;return"onRowActivate"===n&&(u=!1!==l.component.openRecord(e)&&u),u}),Wl.b,Wl.a)),u.pb(11,4440064,[[1,4],["queueGrid",4]],0,Zl.a,[g.a,m.a,Tl.a,Yl.a],{dataSource:[0,"dataSource"],persistKey:[1,"persistKey"],hideFields:[2,"hideFields"],pageOffset:[3,"pageOffset"],cellTextGenerator:[4,"cellTextGenerator"]},{onRowActivate:"onRowActivate"}),(l()(),u.qb(12,0,null,null,1,"eg-grid-toolbar-checkbox",[["label","Records With Matches"]],null,[[null,"onChange"]],(function(l,n,e){var u=!0;return"onChange"===n&&(u=!1!==l.component.limitToMatches(e)&&u),u}),fn.b,fn.a)),u.pb(13,114688,null,0,vn.a,[Zl.a],{label:[0,"label"]},{onChange:"onChange"}),(l()(),u.qb(14,0,null,null,1,"eg-grid-toolbar-checkbox",[["label","Non-Imported Records"]],null,[[null,"onChange"]],(function(l,n,e){var u=!0;return"onChange"===n&&(u=!1!==l.component.limitToNonImported(e)&&u),u}),fn.b,fn.a)),u.pb(15,114688,null,0,vn.a,[Zl.a],{label:[0,"label"]},{onChange:"onChange"}),(l()(),u.qb(16,0,null,null,1,"eg-grid-toolbar-checkbox",[["label","Records with Import Errors"]],null,[[null,"onChange"]],(function(l,n,e){var u=!0;return"onChange"===n&&(u=!1!==l.component.limitToImportErrors(e)&&u),u}),fn.b,fn.a)),u.pb(17,114688,null,0,vn.a,[Zl.a],{label:[0,"label"]},{onChange:"onChange"}),(l()(),u.qb(18,0,null,null,1,"eg-grid-column",[["name","id"]],null,null,null,Cn.b,Cn.a)),u.pb(19,114688,null,0,yn.a,[Zl.a],{name:[0,"name"],index:[1,"index"],hidden:[2,"hidden"]},null),(l()(),u.qb(20,0,null,null,1,"eg-grid-column",[["label","Matches"],["name","+matches"]],null,null,null,Cn.b,Cn.a)),u.pb(21,114688,null,0,yn.a,[Zl.a],{name:[0,"name"],label:[1,"label"],cellTemplate:[2,"cellTemplate"]},null),(l()(),u.qb(22,0,null,null,1,"eg-grid-column",[["label","Import Errors"],["name","import_error"]],null,null,null,Cn.b,Cn.a)),u.pb(23,114688,null,0,yn.a,[Zl.a],{name:[0,"name"],label:[1,"label"],cellTemplate:[2,"cellTemplate"]},null),(l()(),u.qb(24,0,null,null,1,"eg-grid-column",[["datatype","timestamp"],["label","Import Date"],["name","import_time"]],null,null,null,Cn.b,Cn.a)),u.pb(25,114688,null,0,yn.a,[Zl.a],{name:[0,"name"],label:[1,"label"],datatype:[2,"datatype"]},null),(l()(),u.qb(26,0,null,null,1,"eg-grid-column",[["label","Imported As"],["name","imported_as"]],null,null,null,Cn.b,Cn.a)),u.pb(27,114688,null,0,yn.a,[Zl.a],{name:[0,"name"],label:[1,"label"],cellTemplate:[2,"cellTemplate"]},null)],(function(l,n){var e=n.component;l(n,4,0,"Deleting Queue..."),l(n,6,0,e.queueSummary&&e.queueSummary.queue),l(n,11,0,e.queueSource,u.ub(1,"cat.vandelay.queue.",e.queueType,""),"language,pagination,price,rec_identifier,eg_tcn_source,eg_identifier,item_barcode,zsource",e.queuePageOffset(),e.cellTextGenerator),l(n,13,0,"Records With Matches"),l(n,15,0,"Non-Imported Records"),l(n,17,0,"Records with Import Errors"),l(n,19,0,"id",!0,!0),l(n,21,0,"+matches","Matches",u.Cb(n,7)),l(n,23,0,"import_error","Import Errors",u.Cb(n,8)),l(n,25,0,"import_time","Import Date","timestamp"),l(n,27,0,"imported_as","Imported As",u.Cb(n,9))}),null)}function An(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"ng-component",[],null,null,null,Pn,kn)),u.pb(1,4308992,null,0,qn,[c.l,c.a,q.a,f.b,v.a,T],null,null)],(function(l,n){l(n,1,0)}),null)}var Rn=u.mb("ng-component",qn,An,{},{},[]),Nn=e("yp+x"),On=e("2XLs"),En=e("F4VR"),Dn=e("1kwX"),Ln=e("WC/f"),Fn=e("XKii");class Qn{constructor(l,n,e,u,t,a,r,o){this.router=l,this.route=n,this.evt=e,this.net=u,this.auth=t,this.pcrud=a,this.bib=r,this.vandelay=o,this.bibDataSource=new en.c,this.authDataSource=new en.c,this.bibDataSource.getRows=l=>this.getBibMatchRows(l),this.cellTextGenerator={selected:l=>this.isOverlayTarget(l.id)+"",eg_record:l=>l.eg_record+""},this.matchRowClick=l=>{this.toggleMergeTarget(l.id)}}toggleMergeTarget(l){if(this.isOverlayTarget(l))delete this.vandelay.importSelection.overlayMap[this.recordId];else{let n=this.vandelay.importSelection;n||(n=new k,this.vandelay.importSelection=n),n.overlayMap[this.recordId]=this.matchMap[l].eg_record()}}isOverlayTarget(l){const n=this.vandelay.importSelection;return!!n&&n.overlayMap[this.recordId]===this.matchMap[l].eg_record()}ngOnInit(){}getBibMatchRows(l){return new d.a(l=>{this.getQueuedRecord().then(()=>{const n=this.queuedRecord.matches(),e=[];this.matchMap={},n.forEach(l=>{this.matchMap[l.id()]=l,e.includes(l.eg_record())||e.push(l.eg_record())});const u={};this.bib.getBibSummary(e).subscribe(l=>u[l.id]=l,l=>{},()=>{this.bib.fleshBibUsers(Object.values(u).map(l=>l.record)).then(()=>{n.forEach(n=>{const e={id:n.id(),eg_record:n.eg_record(),bre_quality:n.quality(),vqbr_quality:this.queuedRecord.quality(),match_score:n.match_score(),bib_summary:u[n.eg_record()]};l.next(e)}),l.complete()})})})})}getQueuedRecord(){if(this.queuedRecord)return Promise.resolve("");const l="bib"===this.queueType?"vqbr":"vqar",n={flesh:1,flesh_fields:{}};return n.flesh_fields[l]=["matches"],this.pcrud.retrieve(l,this.recordId,n).toPromise().then(l=>this.queuedRecord=l)}}var Hn=u.ob({encapsulation:2,styles:[],data:{}});function Bn(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,2,"a",[],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,1).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),t}),null,null)),u.pb(1,671744,null,0,c.n,[c.l,c.a,i.m],{routerLink:[0,"routerLink"]},null),(l()(),u.Kb(2,null,[" "," "]))],(function(l,n){l(n,1,0,u.ub(1,"/staff/catalog/record/",n.context.row.eg_record,"/marc_view"))}),(function(l,n){l(n,0,0,u.Cb(n,1).target,u.Cb(n,1).href),l(n,2,0,n.context.row.eg_record)}))}function Un(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,2,null,null,null,null,null,null,null)),(l()(),u.qb(1,0,null,null,1,"span",[["class","material-icons"],["title","Selected Merge Target"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["check_circle"]))],null,null)}function jn(l){return u.Mb(0,[(l()(),u.fb(16777216,null,null,1,null,Un)),u.pb(1,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(0,null,null,0))],(function(l,n){l(n,1,0,n.component.isOverlayTarget(n.context.row.id))}),null)}function Gn(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,24,null,null,null,null,null,null,null)),(l()(),u.qb(1,0,null,null,23,"eg-grid",[],null,[[null,"onRowClick"]],(function(l,n,e){var u=!0;return"onRowClick"===n&&(u=!1!==l.component.matchRowClick(e)&&u),u}),Wl.b,Wl.a)),u.pb(2,4440064,[[1,4],["bibGrid",4]],0,Zl.a,[g.a,m.a,Tl.a,Yl.a],{dataSource:[0,"dataSource"],disableSelect:[1,"disableSelect"],disableMultiSelect:[2,"disableMultiSelect"],cellTextGenerator:[3,"cellTextGenerator"]},{onRowClick:"onRowClick"}),(l()(),u.qb(3,0,null,null,1,"eg-grid-column",[["label","Match ID"],["name","id"]],null,null,null,Cn.b,Cn.a)),u.pb(4,114688,null,0,yn.a,[Zl.a],{name:[0,"name"],label:[1,"label"],index:[2,"index"],hidden:[3,"hidden"]},null),(l()(),u.qb(5,0,null,null,1,"eg-grid-column",[["label","Merge Target"],["name","selected"]],null,null,null,Cn.b,Cn.a)),u.pb(6,114688,null,0,yn.a,[Zl.a],{name:[0,"name"],label:[1,"label"],cellTemplate:[2,"cellTemplate"]},null),(l()(),u.qb(7,0,null,null,1,"eg-grid-column",[["label","Record ID"],["name","eg_record"]],null,null,null,Cn.b,Cn.a)),u.pb(8,114688,null,0,yn.a,[Zl.a],{name:[0,"name"],label:[1,"label"],cellTemplate:[2,"cellTemplate"]},null),(l()(),u.qb(9,0,null,null,1,"eg-grid-column",[["label","Match Score"],["name","match_score"]],null,null,null,Cn.b,Cn.a)),u.pb(10,114688,null,0,yn.a,[Zl.a],{name:[0,"name"],label:[1,"label"]},null),(l()(),u.qb(11,0,null,null,1,"eg-grid-column",[["label","Matched Record Quality"],["name","bre_quality"]],null,null,null,Cn.b,Cn.a)),u.pb(12,114688,null,0,yn.a,[Zl.a],{name:[0,"name"],label:[1,"label"]},null),(l()(),u.qb(13,0,null,null,1,"eg-grid-column",[["label","Queued Record Quality"],["name","vqbr_quality"]],null,null,null,Cn.b,Cn.a)),u.pb(14,114688,null,0,yn.a,[Zl.a],{name:[0,"name"],label:[1,"label"]},null),(l()(),u.qb(15,0,null,null,1,"eg-grid-column",[["label","Title"],["path","bib_summary.display.title"]],null,null,null,Cn.b,Cn.a)),u.pb(16,114688,null,0,yn.a,[Zl.a],{path:[0,"path"],label:[1,"label"]},null),(l()(),u.qb(17,0,null,null,1,"eg-grid-column",[["label","Creator"],["path","bib_summary.record.creator.usrname"]],null,null,null,Cn.b,Cn.a)),u.pb(18,114688,null,0,yn.a,[Zl.a],{path:[0,"path"],label:[1,"label"]},null),(l()(),u.qb(19,0,null,null,1,"eg-grid-column",[["datatype","timestamp"],["label","Create Date"],["path","bib_summary.record.create_date"]],null,null,null,Cn.b,Cn.a)),u.pb(20,114688,null,0,yn.a,[Zl.a],{path:[0,"path"],label:[1,"label"],datatype:[2,"datatype"]},null),(l()(),u.qb(21,0,null,null,1,"eg-grid-column",[["label","Editor"],["path","bib_summary.record.editor.usrname"]],null,null,null,Cn.b,Cn.a)),u.pb(22,114688,null,0,yn.a,[Zl.a],{path:[0,"path"],label:[1,"label"]},null),(l()(),u.qb(23,0,null,null,1,"eg-grid-column",[["datatype","timestamp"],["label","Edit Date"],["path","bib_summary.record.edit_date"]],null,null,null,Cn.b,Cn.a)),u.pb(24,114688,null,0,yn.a,[Zl.a],{path:[0,"path"],label:[1,"label"],datatype:[2,"datatype"]},null)],(function(l,n){var e=n.component;l(n,2,0,e.bibDataSource,!0,!0,e.cellTextGenerator),l(n,4,0,"id","Match ID",!0,!0),l(n,6,0,"selected","Merge Target",u.Cb(n.parent,3)),l(n,8,0,"eg_record","Record ID",u.Cb(n.parent,2)),l(n,10,0,"match_score","Match Score"),l(n,12,0,"bre_quality","Matched Record Quality"),l(n,14,0,"vqbr_quality","Queued Record Quality"),l(n,16,0,"bib_summary.display.title","Title"),l(n,18,0,"bib_summary.record.creator.usrname","Creator"),l(n,20,0,"bib_summary.record.create_date","Create Date","timestamp"),l(n,22,0,"bib_summary.record.editor.usrname","Editor"),l(n,24,0,"bib_summary.record.edit_date","Edit Date","timestamp")}),null)}function zn(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,4,null,null,null,null,null,null,null)),(l()(),u.qb(1,0,null,null,3,"eg-grid",[],null,null,null,Wl.b,Wl.a)),u.pb(2,4440064,[[2,4],["authGrid",4]],0,Zl.a,[g.a,m.a,Tl.a,Yl.a],{dataSource:[0,"dataSource"]},null),(l()(),u.qb(3,0,null,null,1,"eg-grid-column",[["label","Match ID"],["name","id"]],null,null,null,Cn.b,Cn.a)),u.pb(4,114688,null,0,yn.a,[Zl.a],{name:[0,"name"],label:[1,"label"],index:[2,"index"],hidden:[3,"hidden"]},null)],(function(l,n){l(n,2,0,n.component.authDataSource),l(n,4,0,"id","Match ID",!0,!0)}),null)}function $n(l){return u.Mb(0,[u.Ib(671088640,1,{bibGrid:0}),u.Ib(671088640,2,{authGrid:0}),(l()(),u.fb(0,[["bibIdTemplate",2]],null,0,null,Bn)),(l()(),u.fb(0,[["targetTemplate",2]],null,0,null,jn)),(l()(),u.fb(16777216,null,null,1,null,Gn)),u.pb(5,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,zn)),u.pb(7,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null)],(function(l,n){var e=n.component;l(n,5,0,"bib"==e.queueType),l(n,7,0,"authority"==e.queueType)}),null)}class Vn{constructor(l,n,e,u){this.net=l,this.auth=n,this.pcrud=e,this.vandelay=u,this.gridSource=new en.c,this.gridSource.getRows=l=>this.pcrud.search("vii",{record:this.recordId},{order_by:{vii:["id"]}})}}var Xn=u.ob({encapsulation:2,styles:[],data:{}});function Jn(l){return u.Mb(0,[u.Ib(402653184,1,{itemsGrid:0}),(l()(),u.qb(1,0,null,null,1,"eg-grid",[["idlClass","vii"],["persistKey","cat.vandelay.queue.bib.items"],["showFields","record,import_error,imported_as,import_time,owning_lib,call_number,barcode"]],null,null,null,Wl.b,Wl.a)),u.pb(2,4440064,[[1,4],["itemsGrid",4]],0,Zl.a,[g.a,m.a,Tl.a,Yl.a],{dataSource:[0,"dataSource"],idlClass:[1,"idlClass"],persistKey:[2,"persistKey"],showFields:[3,"showFields"]},null)],(function(l,n){l(n,2,0,n.component.gridSource,"vii","cat.vandelay.queue.bib.items","record,import_error,imported_as,import_time,owning_lib,call_number,barcode")}),null)}class Wn{constructor(l,n,e){this.router=l,this.route=n,this.pcrud=e,this.route.paramMap.subscribe(l=>{this.queueId=+l.get("id"),this.recordId=+l.get("recordId"),this.queueType=l.get("qtype"),this.recordTab=l.get("recordTab"),"edit"===this.recordTab&&this.loadRecord()})}onTabChange(l){this.recordTab=l.nextId,l.preventDefault(),this.router.navigate([`/staff/cat/vandelay/queue/${this.queueType}/${this.queueId}/record/${this.recordId}/${this.recordTab}`])}loadRecord(){this.queuedRecord=null,this.pcrud.retrieve("bib"===this.queueType?"vqbr":"vqar",this.recordId).subscribe(l=>this.queuedRecord=l)}handleMarcRecordSaved(l){this.queuedRecord.marc(l.marcXml),"bib"===this.queueType&&this.queuedRecord.bib_source(l.bibSource),this.pcrud.update(this.queuedRecord).subscribe(l=>{console.log("response = ",l)})}}var Zn=u.ob({encapsulation:2,styles:[],data:{}});function Yn(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"eg-marc-html",[],null,null,null,Nn.b,Nn.a)),u.pb(1,114688,null,0,On.a,[u.k,f.b,v.a],{recordId:[0,"recordId"],recordType:[1,"recordType"]},null)],(function(l,n){var e=n.component;l(n,1,0,e.recordId,"vandelay-"+e.queueType)}),null)}function le(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"eg-marc-editor",[],null,[[null,"recordSaved"]],(function(l,n,e){var u=!0;return"recordSaved"===n&&(u=!1!==l.component.handleMarcRecordSaved(e)&&u),u}),En.b,En.a)),u.pb(1,114688,null,0,Dn.a,[q.a,g.a,f.b,v.a,m.a,C.a,Q.a,Ln.a,Tl.a],{recordXml:[0,"recordXml"],recordSource:[1,"recordSource"],inPlaceMode:[2,"inPlaceMode"]},{recordSaved:"recordSaved"})],(function(l,n){var e=n.component;l(n,1,0,e.queuedRecord.marc(),e.queuedRecord.bib_source(),!0)}),null)}function ne(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"eg-marc-editor",[],null,[[null,"recordSaved"]],(function(l,n,e){var u=!0;return"recordSaved"===n&&(u=!1!==l.component.handleMarcRecordSaved(e)&&u),u}),En.b,En.a)),u.pb(1,114688,null,0,Dn.a,[q.a,g.a,f.b,v.a,m.a,C.a,Q.a,Ln.a,Tl.a],{recordXml:[0,"recordXml"],inPlaceMode:[1,"inPlaceMode"]},{recordSaved:"recordSaved"})],(function(l,n){l(n,1,0,n.component.queuedRecord.marc(),!0)}),null)}function ee(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,4,null,null,null,null,null,null,null)),(l()(),u.fb(16777216,null,null,1,null,le)),u.pb(2,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,ne)),u.pb(4,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(0,null,null,0))],(function(l,n){var e=n.component;l(n,2,0,"bib"===e.queueType),l(n,4,0,"bib"!==e.queueType)}),null)}function ue(l){return u.Mb(0,[(l()(),u.fb(16777216,null,null,1,null,ee)),u.pb(1,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(0,null,null,0))],(function(l,n){l(n,1,0,n.component.queuedRecord)}),null)}function te(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"eg-queued-record-matches",[],null,null,null,$n,Hn)),u.pb(1,114688,null,0,Qn,[c.l,c.a,q.a,f.b,v.a,C.a,Fn.a,T],{queueType:[0,"queueType"],recordId:[1,"recordId"]},null)],(function(l,n){var e=n.component;l(n,1,0,e.queueType,e.recordId)}),null)}function ae(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"eg-queued-record-items",[],null,null,null,Jn,Xn)),u.pb(1,49152,null,0,Vn,[f.b,v.a,C.a,T],{recordId:[0,"recordId"]},null)],(function(l,n){l(n,1,0,n.component.recordId)}),null)}function re(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,7,"div",[["class","row mb-3"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,6,"div",[["class","col-lg-2"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,5,"button",[["class","btn btn-info label-with-material-icon"]],null,[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,3).onClick()&&t),t}),null,null)),u.pb(3,16384,null,0,c.m,[c.l,c.a,[8,null],u.C,u.k],{routerLink:[0,"routerLink"]},null),(l()(),u.qb(4,0,null,null,1,"span",[["class","material-icons"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["arrow_back"])),(l()(),u.qb(6,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Return to Queue"])),(l()(),u.qb(8,0,null,null,26,"ngb-tabset",[],null,[[null,"tabChange"]],(function(l,n,e){var u=!0;return"tabChange"===n&&(u=!1!==l.component.onTabChange(e)&&u),u}),r.k,r.f)),u.pb(9,2146304,[["recordTabs",4]],1,A.eb,[A.fb],{activeId:[0,"activeId"]},{tabChange:"tabChange"}),u.Ib(603979776,1,{tabs:1}),(l()(),u.qb(11,0,null,null,5,"ngb-tab",[["id","marc"],["title","Queued Record MARC"]],null,null,null,null,null)),u.pb(12,2113536,[[1,4]],2,A.bb,[],{id:[0,"id"],title:[1,"title"]},null),u.Ib(603979776,2,{titleTpls:1}),u.Ib(603979776,3,{contentTpls:1}),(l()(),u.fb(0,null,null,1,null,Yn)),u.pb(16,16384,[[3,4]],0,A.cb,[u.K],null,null),(l()(),u.qb(17,0,null,null,5,"ngb-tab",[["id","edit"],["title","Edit Record"]],null,null,null,null,null)),u.pb(18,2113536,[[1,4]],2,A.bb,[],{id:[0,"id"],title:[1,"title"]},null),u.Ib(603979776,4,{titleTpls:1}),u.Ib(603979776,5,{contentTpls:1}),(l()(),u.fb(0,null,null,1,null,ue)),u.pb(22,16384,[[5,4]],0,A.cb,[u.K],null,null),(l()(),u.qb(23,0,null,null,5,"ngb-tab",[["id","matches"],["title","Record Matches"]],null,null,null,null,null)),u.pb(24,2113536,[[1,4]],2,A.bb,[],{id:[0,"id"],title:[1,"title"]},null),u.Ib(603979776,6,{titleTpls:1}),u.Ib(603979776,7,{contentTpls:1}),(l()(),u.fb(0,null,null,1,null,te)),u.pb(28,16384,[[7,4]],0,A.cb,[u.K],null,null),(l()(),u.qb(29,0,null,null,5,"ngb-tab",[["id","items"],["title","Import Items"]],null,null,null,null,null)),u.pb(30,2113536,[[1,4]],2,A.bb,[],{id:[0,"id"],title:[1,"title"]},null),u.Ib(603979776,8,{titleTpls:1}),u.Ib(603979776,9,{contentTpls:1}),(l()(),u.fb(0,null,null,1,null,ae)),u.pb(34,16384,[[9,4]],0,A.cb,[u.K],null,null)],(function(l,n){var e=n.component;l(n,3,0,u.ub(2,"/staff/cat/vandelay/queue/",e.queueType,"/",e.queueId,"")),l(n,9,0,e.recordTab),l(n,12,0,"marc","Queued Record MARC"),l(n,18,0,"edit","Edit Record"),l(n,24,0,"matches","Record Matches"),l(n,30,0,"items","Import Items")}),null)}function oe(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"ng-component",[],null,null,null,re,Zn)),u.pb(1,49152,null,0,Wn,[c.l,c.a,C.a],null,null)],null,null)}var se=u.mb("ng-component",Wn,oe,{},{},[]);class ie{constructor(l,n,e,u,t){this.router=l,this.route=n,this.net=e,this.auth=u,this.vandelay=t,this.route.paramMap.subscribe(l=>{this.queueId=+l.get("id"),this.queueType=l.get("qtype")}),this.gridSource=new en.c,this.gridSource.getRows=l=>this.net.request("open-ils.vandelay","open-ils.vandelay.import_item.queue.retrieve",this.auth.token(),this.queueId,{with_import_error:this.filterImportErrors,offset:l.offset,limit:l.limit})}limitToImportErrors(l){this.filterImportErrors=l,this.itemsGrid.reload()}}var ce=u.ob({encapsulation:2,styles:[],data:{}});function be(l){return u.Mb(0,[u.Ib(402653184,1,{itemsGrid:0}),(l()(),u.qb(1,0,null,null,7,"div",[["class","row mb-3"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,6,"div",[["class","col-lg-2"]],null,null,null,null,null)),(l()(),u.qb(3,0,null,null,5,"button",[["class","btn btn-info label-with-material-icon"]],null,[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,4).onClick()&&t),t}),null,null)),u.pb(4,16384,null,0,c.m,[c.l,c.a,[8,null],u.C,u.k],{routerLink:[0,"routerLink"]},null),(l()(),u.qb(5,0,null,null,1,"span",[["class","material-icons"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["arrow_back"])),(l()(),u.qb(7,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Return to Queue"])),(l()(),u.qb(9,0,null,null,3,"eg-grid",[["idlClass","vii"],["persistKey","cat.vandelay.queue.items"],["showFields","record,import_error,imported_as,import_time,owning_lib,call_number,barcode"]],null,null,null,Wl.b,Wl.a)),u.pb(10,4440064,[[1,4],["itemsGrid",4]],0,Zl.a,[g.a,m.a,Tl.a,Yl.a],{dataSource:[0,"dataSource"],idlClass:[1,"idlClass"],persistKey:[2,"persistKey"],showFields:[3,"showFields"]},null),(l()(),u.qb(11,0,null,null,1,"eg-grid-toolbar-checkbox",[["label","Limit to Import Failures"]],null,[[null,"onChange"]],(function(l,n,e){var u=!0;return"onChange"===n&&(u=!1!==l.component.limitToImportErrors(e)&&u),u}),fn.b,fn.a)),u.pb(12,114688,null,0,vn.a,[Zl.a],{label:[0,"label"]},{onChange:"onChange"})],(function(l,n){var e=n.component;l(n,4,0,u.ub(2,"/staff/cat/vandelay/queue/",e.queueType,"/",e.queueId,"")),l(n,10,0,e.gridSource,"vii","cat.vandelay.queue.items","record,import_error,imported_as,import_time,owning_lib,call_number,barcode"),l(n,12,0,"Limit to Import Failures")}),null)}function de(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"ng-component",[],null,null,null,be,ce)),u.pb(1,49152,null,0,ie,[c.l,c.a,f.b,v.a,T],null,null)],null,null)}var pe=u.mb("ng-component",ie,de,{},{},[]),he=e("3ibj"),ge=e("RAh1");class me{constructor(l,n){this.router=l,this.route=n,this.route.paramMap.subscribe(l=>{this.attrType=l.get("atype")})}onTabChange(l){this.attrType=l.nextId,l.preventDefault(),this.router.navigate(["/staff/cat/vandelay/display_attrs/"+this.attrType])}}var fe=u.ob({encapsulation:2,styles:[],data:{}});function ve(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,2,"div",[["class","mt-3"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,1,"eg-admin-page",[["idlClass","vqbrad"]],null,null,null,he.b,he.a)),u.pb(2,114688,null,0,ge.a,[c.a,i.l,Yl.a,g.a,m.a,v.a,C.a,y.a,Q.a],{idlClass:[0,"idlClass"]},null)],(function(l,n){l(n,2,0,"vqbrad")}),null)}function Ce(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,2,"div",[["class","mt-3"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,1,"eg-admin-page",[["idlClass","vqarad"]],null,null,null,he.b,he.a)),u.pb(2,114688,null,0,ge.a,[c.a,i.l,Yl.a,g.a,m.a,v.a,C.a,y.a,Q.a],{idlClass:[0,"idlClass"]},null)],(function(l,n){l(n,2,0,"vqarad")}),null)}function ye(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,14,"ngb-tabset",[],null,[[null,"tabChange"]],(function(l,n,e){var u=!0;return"tabChange"===n&&(u=!1!==l.component.onTabChange(e)&&u),u}),r.k,r.f)),u.pb(1,2146304,[["tabs",4]],1,A.eb,[A.fb],{activeId:[0,"activeId"]},{tabChange:"tabChange"}),u.Ib(603979776,1,{tabs:1}),(l()(),u.qb(3,0,null,null,5,"ngb-tab",[["id","bib"],["title","Bibliographic Attributes"]],null,null,null,null,null)),u.pb(4,2113536,[[1,4]],2,A.bb,[],{id:[0,"id"],title:[1,"title"]},null),u.Ib(603979776,2,{titleTpls:1}),u.Ib(603979776,3,{contentTpls:1}),(l()(),u.fb(0,null,null,1,null,ve)),u.pb(8,16384,[[3,4]],0,A.cb,[u.K],null,null),(l()(),u.qb(9,0,null,null,5,"ngb-tab",[["id","authority"],["title","Authority Attributes"]],null,null,null,null,null)),u.pb(10,2113536,[[1,4]],2,A.bb,[],{id:[0,"id"],title:[1,"title"]},null),u.Ib(603979776,4,{titleTpls:1}),u.Ib(603979776,5,{contentTpls:1}),(l()(),u.fb(0,null,null,1,null,Ce)),u.pb(14,16384,[[5,4]],0,A.cb,[u.K],null,null)],(function(l,n){l(n,1,0,n.component.attrType),l(n,4,0,"bib","Bibliographic Attributes"),l(n,10,0,"authority","Authority Attributes")}),null)}function qe(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"ng-component",[],null,null,null,ye,fe)),u.pb(1,49152,null,0,me,[c.l,c.a],null,null)],null,null)}var ke=u.mb("ng-component",me,qe,{},{},[]);class Te{constructor(){}}var Ie=u.ob({encapsulation:2,styles:[],data:{}});function Se(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"eg-admin-page",[["idlClass","vmp"]],null,null,null,he.b,he.a)),u.pb(1,114688,null,0,ge.a,[c.a,i.l,Yl.a,g.a,m.a,v.a,C.a,y.a,Q.a],{idlClass:[0,"idlClass"]},null)],(function(l,n){l(n,1,0,"vmp")}),null)}function we(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"ng-component",[],null,null,null,Se,Ie)),u.pb(1,49152,null,0,Te,[],null,null)],null,null)}var Me=u.mb("ng-component",Te,we,{},{},[]);class Ke{constructor(){}}var _e=u.ob({encapsulation:2,styles:[],data:{}});function xe(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"eg-admin-page",[["idlClass","viiad"]],null,null,null,he.b,he.a)),u.pb(1,114688,null,0,ge.a,[c.a,i.l,Yl.a,g.a,m.a,v.a,C.a,y.a,Q.a],{idlClass:[0,"idlClass"]},null)],(function(l,n){l(n,1,0,"viiad")}),null)}function Pe(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"ng-component",[],null,null,null,xe,_e)),u.pb(1,49152,null,0,Ke,[],null,null)],null,null)}var Ae=u.mb("ng-component",Ke,Pe,{},{},[]),Re=e("gBxT"),Ne=e("wVJ/"),Oe=e("Id+k"),Ee=e("eXX1"),De=e("7Apk"),Le=e("UUQ6");class Fe{constructor(l,n,e,u){this.router=l,this.pcrud=n,this.auth=e,this.org=u,this.gridSource=new en.c,this.contextOrg=this.org.get(this.auth.user().ws_ou()),this.gridSource.getRows=l=>{const n=this.org.ancestors(this.contextOrg,!0);return this.pcrud.search("vms",{owner:n},{order_by:{vms:["name"]},limit:l.limit,offset:l.offset})},this.cellTextGenerator={name:l=>l.name()},this.createNew=()=>{this.editDialog.mode="create",this.editDialog.open({size:"lg"}).subscribe(()=>this.grid.reload())},this.deleteSelected=l=>{l.forEach(l=>l.isdeleted(!0)),this.pcrud.autoApply(l).subscribe(l=>console.debug("deleted: "+l),l=>{},()=>this.grid.reload())}}ngAfterViewInit(){this.grid.onRowActivate.subscribe(l=>{this.editDialog.mode="update",this.editDialog.recordId=l.id(),this.editDialog.open({size:"lg"}).subscribe(()=>this.grid.reload())})}orgOnChange(l){this.contextOrg=l,this.grid.reload()}}var Qe=u.ob({encapsulation:2,styles:[],data:{}});function He(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,2,"a",[],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,1).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),t}),null,null)),u.pb(1,671744,null,0,c.n,[c.l,c.a,i.m],{routerLink:[0,"routerLink"]},null),(l()(),u.Kb(2,null,[" "," "]))],(function(l,n){var e=u.ub(1,"/staff/cat/vandelay/match_sets/",n.context.row.id(),"/editor");l(n,1,0,e)}),(function(l,n){l(n,0,0,u.Cb(n,1).target,u.Cb(n,1).href);var e=n.context.row.name();l(n,2,0,e)}))}function Be(l){return u.Mb(0,[u.Ib(402653184,1,{grid:0}),u.Ib(402653184,2,{editDialog:0}),(l()(),u.qb(2,0,null,null,7,"div",[["class","d-flex mb-3"]],null,null,null,null,null)),(l()(),u.qb(3,0,null,null,6,"div",[],null,null,null,null,null)),(l()(),u.qb(4,0,null,null,5,"div",[["class","input-group"]],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,2,"div",[["class","input-group-prepend"]],null,null,null,null,null)),(l()(),u.qb(6,0,null,null,1,"span",[["class","input-group-text"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Owner"])),(l()(),u.qb(8,0,null,null,1,"eg-org-select",[],null,[[null,"onChange"]],(function(l,n,e){var u=!0;return"onChange"===n&&(u=!1!==l.component.orgOnChange(e)&&u),u}),Re.b,Re.a)),u.pb(9,114688,null,0,Ne.a,[v.a,O.a,m.a,y.a],{initialOrg:[0,"initialOrg"]},{onChange:"onChange"}),(l()(),u.fb(0,[["nameTmpl",2]],null,0,null,He)),(l()(),u.qb(11,0,null,null,7,"eg-grid",[["idlClass","vms"],["persistKey","cat.vandelay.match_set.list"]],null,null,null,Wl.b,Wl.a)),u.pb(12,4440064,[[1,4],["grid",4]],0,Zl.a,[g.a,m.a,Tl.a,Yl.a],{dataSource:[0,"dataSource"],idlClass:[1,"idlClass"],persistKey:[2,"persistKey"],cellTextGenerator:[3,"cellTextGenerator"]},null),(l()(),u.qb(13,0,null,null,1,"eg-grid-toolbar-button",[["label","New Match Set"]],null,null,null,Oe.b,Oe.a)),u.pb(14,114688,null,0,Ee.a,[Zl.a],{label:[0,"label"],action:[1,"action"]},null),(l()(),u.qb(15,0,null,null,1,"eg-grid-toolbar-action",[["label","Delete Selected"]],null,null,null,ln.b,ln.a)),u.pb(16,114688,null,0,nn.a,[Zl.a],{label:[0,"label"],action:[1,"action"]},null),(l()(),u.qb(17,0,null,null,1,"eg-grid-column",[["name","name"]],null,null,null,Cn.b,Cn.a)),u.pb(18,114688,null,0,yn.a,[Zl.a],{name:[0,"name"],cellTemplate:[1,"cellTemplate"]},null),(l()(),u.qb(19,0,null,null,7,"eg-fm-record-editor",[["idlClass","vms"]],null,null,null,De.b,De.a)),u.pb(20,114688,[[2,4],["editDialog",4]],0,Le.a,[A.E,g.a,v.a,Q.a,Yl.a,C.a],{idlClass:[0,"idlClass"],fieldOptions:[1,"fieldOptions"]},null),u.Fb(21,{id:0}),u.Fb(22,{id:0}),u.Fb(23,{id:0}),u.Db(24,3),u.Fb(25,{customValues:0}),u.Fb(26,{mtype:0})],(function(l,n){var e=n.component;l(n,9,0,e.contextOrg),l(n,12,0,e.gridSource,"vms","cat.vandelay.match_set.list",e.cellTextGenerator),l(n,14,0,"New Match Set",e.createNew),l(n,16,0,"Delete Selected",e.deleteSelected),l(n,18,0,"name",u.Cb(n,10));var t=l(n,26,0,l(n,25,0,l(n,24,0,l(n,21,0,"biblio"),l(n,22,0,"serial"),l(n,23,0,"authority"))));l(n,20,0,"vms",t)}),null)}function Ue(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"ng-component",[],null,null,null,Be,Qe)),u.pb(1,4243456,null,0,Fe,[c.l,C.a,v.a,m.a],null,null)],null,null)}var je=u.mb("ng-component",Fe,Ue,{},{},[]),Ge=e("yRwz"),ze=e("d4sd"),$e=e("StZw"),Ve=e("tNQm"),Xe=e("G8BM");class Je{}class We{constructor(l,n){this.idl=l,this.pcrud=n,this.values=new Je,this.bibAttrDefs=[],this.bibAttrDefEntries=[]}set pointType(l){this.values.pointType=l,this.values.recordAttr="",this.values.matchScore=1,this.values.negate=!1,this.values.marcTag="",this.values.marcSf="",this.values.boolOp="AND",this.values.value=""}ngOnInit(){this.pcrud.retrieveAll("crad",{order_by:{crad:"label"}}).subscribe(l=>{this.bibAttrDefs.push(l),this.bibAttrDefEntries.push({id:l.name(),label:l.label()})})}setNewPointType(l){}}var Ze=u.ob({encapsulation:2,styles:[],data:{}});function Ye(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,7,null,null,null,null,null,null,null)),(l()(),u.qb(1,0,null,null,6,"div",[["class","row mb-1"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,1,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Record Attribute:"])),(l()(),u.qb(4,0,null,null,3,"div",[["class","col-lg-4"]],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,2,"eg-combobox",[["placeholder","Record Attribute..."]],null,[[null,"onChange"]],(function(l,n,e){var u=!0;return"onChange"===n&&(u=!1!==(l.component.values.recordAttr=e?e.id:"")&&u),u}),R.b,R.a)),u.Hb(5120,null,_.o,(function(l){return[l]}),[N.a]),u.pb(7,114688,null,0,N.a,[u.k,O.a,g.a,C.a],{placeholder:[0,"placeholder"],required:[1,"required"],entries:[2,"entries"]},{onChange:"onChange"})],(function(l,n){l(n,7,0,"Record Attribute...",!0,n.component.bibAttrDefEntries)}),null)}function lu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,24,null,null,null,null,null,null,null)),(l()(),u.qb(1,0,null,null,11,"div",[["class","row mb-1"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,1,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Tag:"])),(l()(),u.qb(4,0,null,null,8,"div",[["class","col-lg-2"]],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,7,"input",[["class","form-control"],["required",""],["type","text"]],[[1,"required",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(l,n,e){var t=!0,a=l.component;return"input"===n&&(t=!1!==u.Cb(l,6)._handleInput(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,6).onTouched()&&t),"compositionstart"===n&&(t=!1!==u.Cb(l,6)._compositionStart()&&t),"compositionend"===n&&(t=!1!==u.Cb(l,6)._compositionEnd(e.target.value)&&t),"ngModelChange"===n&&(t=!1!==(a.values.marcTag=e)&&t),t}),null,null)),u.pb(6,16384,null,0,_.d,[u.C,u.k,[2,_.a]],null,null),u.pb(7,16384,null,0,_.y,[],{required:[0,"required"]},null),u.Hb(1024,null,_.n,(function(l){return[l]}),[_.y]),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.d]),u.pb(10,671744,null,0,_.t,[[8,null],[6,_.n],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(12,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.qb(13,0,null,null,11,"div",[["class","row mb-1"]],null,null,null,null,null)),(l()(),u.qb(14,0,null,null,1,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Subfield ‡:"])),(l()(),u.qb(16,0,null,null,8,"div",[["class","col-lg-2"]],null,null,null,null,null)),(l()(),u.qb(17,0,null,null,7,"input",[["class","form-control"],["required",""],["type","text"]],[[1,"required",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(l,n,e){var t=!0,a=l.component;return"input"===n&&(t=!1!==u.Cb(l,18)._handleInput(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,18).onTouched()&&t),"compositionstart"===n&&(t=!1!==u.Cb(l,18)._compositionStart()&&t),"compositionend"===n&&(t=!1!==u.Cb(l,18)._compositionEnd(e.target.value)&&t),"ngModelChange"===n&&(t=!1!==(a.values.marcSf=e)&&t),t}),null,null)),u.pb(18,16384,null,0,_.d,[u.C,u.k,[2,_.a]],null,null),u.pb(19,16384,null,0,_.y,[],{required:[0,"required"]},null),u.Hb(1024,null,_.n,(function(l){return[l]}),[_.y]),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.d]),u.pb(22,671744,null,0,_.t,[[8,null],[6,_.n],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(24,16384,null,0,_.q,[[4,_.p]],null,null)],(function(l,n){var e=n.component;l(n,7,0,""),l(n,10,0,e.values.marcTag),l(n,19,0,""),l(n,22,0,e.values.marcSf)}),(function(l,n){l(n,5,0,u.Cb(n,7).required?"":null,u.Cb(n,12).ngClassUntouched,u.Cb(n,12).ngClassTouched,u.Cb(n,12).ngClassPristine,u.Cb(n,12).ngClassDirty,u.Cb(n,12).ngClassValid,u.Cb(n,12).ngClassInvalid,u.Cb(n,12).ngClassPending),l(n,17,0,u.Cb(n,19).required?"":null,u.Cb(n,24).ngClassUntouched,u.Cb(n,24).ngClassTouched,u.Cb(n,24).ngClassPristine,u.Cb(n,24).ngClassDirty,u.Cb(n,24).ngClassValid,u.Cb(n,24).ngClassInvalid,u.Cb(n,24).ngClassPending)}))}function nu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,5,null,null,null,null,null,null,null)),(l()(),u.qb(1,0,null,null,4,"div",[["class","row mb-1"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,1,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Normalized Heading:"])),(l()(),u.qb(4,0,null,null,1,"div",[["class","col-lg-2"]],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,0,"input",[["checked",""],["class","form-check-input"],["disabled",""],["type","checkbox"]],null,null,null,null,null))],null,null)}function eu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,10,null,null,null,null,null,null,null)),(l()(),u.qb(1,0,null,null,9,"div",[["class","row mb-1"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,1,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Negate:"])),(l()(),u.qb(4,0,null,null,6,"div",[["class","col-lg-2"]],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,5,"input",[["class","form-check-input"],["type","checkbox"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(l,n,e){var t=!0,a=l.component;return"change"===n&&(t=!1!==u.Cb(l,6).onChange(e.target.checked)&&t),"blur"===n&&(t=!1!==u.Cb(l,6).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.values.negate=e)&&t),t}),null,null)),u.pb(6,16384,null,0,_.b,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.b]),u.pb(8,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(10,16384,null,0,_.q,[[4,_.p]],null,null)],(function(l,n){l(n,8,0,n.component.values.negate)}),(function(l,n){l(n,5,0,u.Cb(n,10).ngClassUntouched,u.Cb(n,10).ngClassTouched,u.Cb(n,10).ngClassPristine,u.Cb(n,10).ngClassDirty,u.Cb(n,10).ngClassValid,u.Cb(n,10).ngClassInvalid,u.Cb(n,10).ngClassPending)}))}function uu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,15,null,null,null,null,null,null,null)),(l()(),u.qb(1,0,null,null,12,"div",[["class","row mb-1"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,1,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Match Score:"])),(l()(),u.qb(4,0,null,null,9,"div",[["class","col-lg-2"]],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,8,"input",[["class","form-control"],["required",""],["step","0.1"],["type","number"]],[[1,"required",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],(function(l,n,e){var t=!0,a=l.component;return"input"===n&&(t=!1!==u.Cb(l,6)._handleInput(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,6).onTouched()&&t),"compositionstart"===n&&(t=!1!==u.Cb(l,6)._compositionStart()&&t),"compositionend"===n&&(t=!1!==u.Cb(l,6)._compositionEnd(e.target.value)&&t),"change"===n&&(t=!1!==u.Cb(l,7).onChange(e.target.value)&&t),"input"===n&&(t=!1!==u.Cb(l,7).onChange(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,7).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.values.matchScore=e)&&t),t}),null,null)),u.pb(6,16384,null,0,_.d,[u.C,u.k,[2,_.a]],null,null),u.pb(7,16384,null,0,_.v,[u.C,u.k],null,null),u.pb(8,16384,null,0,_.y,[],{required:[0,"required"]},null),u.Hb(1024,null,_.n,(function(l){return[l]}),[_.y]),u.Hb(1024,null,_.o,(function(l,n){return[l,n]}),[_.d,_.v]),u.pb(11,671744,null,0,_.t,[[8,null],[6,_.n],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(13,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.fb(16777216,null,null,1,null,eu)),u.pb(15,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(0,null,null,0))],(function(l,n){var e=n.component;l(n,8,0,""),l(n,11,0,e.values.matchScore),l(n,15,0,!e.isForQuality)}),(function(l,n){l(n,5,0,u.Cb(n,8).required?"":null,u.Cb(n,13).ngClassUntouched,u.Cb(n,13).ngClassTouched,u.Cb(n,13).ngClassPristine,u.Cb(n,13).ngClassDirty,u.Cb(n,13).ngClassValid,u.Cb(n,13).ngClassInvalid,u.Cb(n,13).ngClassPending)}))}function tu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,18,null,null,null,null,null,null,null)),(l()(),u.qb(1,0,null,null,17,"div",[["class","row mb-1"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,1,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Operator:"])),(l()(),u.qb(4,0,null,null,14,"div",[["class","col-lg-2"]],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,13,"select",[["class","form-control"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(l,n,e){var t=!0,a=l.component;return"change"===n&&(t=!1!==u.Cb(l,6).onChange(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,6).onTouched()&&t),"ngModelChange"===n&&(t=!1!==(a.values.boolOp=e)&&t),t}),null,null)),u.pb(6,16384,null,0,_.z,[u.C,u.k],null,null),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.z]),u.pb(8,671744,null,0,_.t,[[8,null],[8,null],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(10,16384,null,0,_.q,[[4,_.p]],null,null),(l()(),u.qb(11,0,null,null,3,"option",[["value","AND"]],null,null,null,null,null)),u.pb(12,147456,null,0,_.u,[u.k,u.C,[2,_.z]],{value:[0,"value"]},null),u.pb(13,147456,null,0,_.F,[u.k,u.C,[8,null]],{value:[0,"value"]},null),(l()(),u.Kb(-1,null,["AND"])),(l()(),u.qb(15,0,null,null,3,"option",[["value","OR"]],null,null,null,null,null)),u.pb(16,147456,null,0,_.u,[u.k,u.C,[2,_.z]],{value:[0,"value"]},null),u.pb(17,147456,null,0,_.F,[u.k,u.C,[8,null]],{value:[0,"value"]},null),(l()(),u.Kb(-1,null,["OR"]))],(function(l,n){l(n,8,0,n.component.values.boolOp),l(n,12,0,"AND"),l(n,13,0,"AND"),l(n,16,0,"OR"),l(n,17,0,"OR")}),(function(l,n){l(n,5,0,u.Cb(n,10).ngClassUntouched,u.Cb(n,10).ngClassTouched,u.Cb(n,10).ngClassPristine,u.Cb(n,10).ngClassDirty,u.Cb(n,10).ngClassValid,u.Cb(n,10).ngClassInvalid,u.Cb(n,10).ngClassPending)}))}function au(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,12,null,null,null,null,null,null,null)),(l()(),u.qb(1,0,null,null,11,"div",[["class","row mb-1"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,1,"div",[["class","col-lg-3"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Value:"])),(l()(),u.qb(4,0,null,null,8,"div",[["class","col-lg-2"]],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,7,"input",[["class","form-control"],["required",""],["type","text"]],[[1,"required",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(l,n,e){var t=!0,a=l.component;return"input"===n&&(t=!1!==u.Cb(l,6)._handleInput(e.target.value)&&t),"blur"===n&&(t=!1!==u.Cb(l,6).onTouched()&&t),"compositionstart"===n&&(t=!1!==u.Cb(l,6)._compositionStart()&&t),"compositionend"===n&&(t=!1!==u.Cb(l,6)._compositionEnd(e.target.value)&&t),"ngModelChange"===n&&(t=!1!==(a.values.value=e)&&t),t}),null,null)),u.pb(6,16384,null,0,_.d,[u.C,u.k,[2,_.a]],null,null),u.pb(7,16384,null,0,_.y,[],{required:[0,"required"]},null),u.Hb(1024,null,_.n,(function(l){return[l]}),[_.y]),u.Hb(1024,null,_.o,(function(l){return[l]}),[_.d]),u.pb(10,671744,null,0,_.t,[[8,null],[6,_.n],[8,null],[6,_.o]],{model:[0,"model"]},{update:"ngModelChange"}),u.Hb(2048,null,_.p,null,[_.t]),u.pb(12,16384,null,0,_.q,[[4,_.p]],null,null)],(function(l,n){var e=n.component;l(n,7,0,""),l(n,10,0,e.values.value)}),(function(l,n){l(n,5,0,u.Cb(n,7).required?"":null,u.Cb(n,12).ngClassUntouched,u.Cb(n,12).ngClassTouched,u.Cb(n,12).ngClassPristine,u.Cb(n,12).ngClassDirty,u.Cb(n,12).ngClassValid,u.Cb(n,12).ngClassInvalid,u.Cb(n,12).ngClassPending)}))}function ru(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,13,"div",[["class","row ml-2 mt-4 p-2 border border-secondary"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,12,"div",[["class","col-lg-12 common-form striped-odd form-validated"]],null,null,null,null,null)),(l()(),u.fb(16777216,null,null,1,null,Ye)),u.pb(3,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,lu)),u.pb(5,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,nu)),u.pb(7,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,uu)),u.pb(9,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,tu)),u.pb(11,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,au)),u.pb(13,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null)],(function(l,n){var e=n.component;l(n,3,0,"attr"==e.values.pointType),l(n,5,0,"marc"==e.values.pointType),l(n,7,0,"heading"==e.values.pointType),l(n,9,0,"bool"!=e.values.pointType),l(n,11,0,"bool"==e.values.pointType),l(n,13,0,e.isForQuality)}),null)}function ou(l){return u.Mb(0,[(l()(),u.fb(16777216,null,null,1,null,ru)),u.pb(1,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null)],(function(l,n){l(n,1,0,n.component.values.pointType)}),null)}var su=e("Mr7b");class iu{constructor(l,n,e,u,t,a){this.idl=l,this.pcrud=n,this.net=e,this.auth=u,this.org=t,this.strings=a,this.newId=-1}set matchSet(l){this.matchSet_=l,l&&!this.initDone&&(this.matchSetType=l.mtype(),this.initDone=!0,this.refreshTree())}ngOnInit(){}refreshTree(){return this.matchSet_?this.pcrud.search("vmsp",{match_set:this.matchSet_.id()},{},{atomic:!0,authoritative:!0}).toPromise().then(l=>{l.length>0?this.ingestMatchPoints(l):this.addRootNode()}):Promise.resolve()}addRootNode(){const l=this.idl.create("vmsp");l.id(this.newId--),l.isnew(!0),l.match_set(this.matchSet_.id()),l.children([]),l.bool_op("AND");const n=new su.b({id:l.id(),callerData:{point:l}});this.tree=new su.a(n),this.setNodeLabel(n,l)}ingestMatchPoints(l){const n=[],e={};l.forEach(l=>{l.negate("t"===l.negate()),l.heading("t"===l.heading()),l.children([]);const u=new su.b({id:l.id(),expanded:!0,callerData:{point:l}});e[u.id+""]=u,this.setNodeLabel(u,l).then(()=>n.push(u))}),l.forEach(l=>{const n=e[l.id()+""];l.parent()?e[l.parent()+""].children.push(n):this.tree=new su.a(n)})}setNodeLabel(l,n){return l.label?Promise.resolve(null):Promise.all([this.getPointLabel(n,!0).then(n=>l.label=n),this.getPointLabel(n,!1).then(n=>l.callerData.slimLabel=n)])}getPointLabel(l,n){return this.strings.interpolate("staff.cat.vandelay.matchpoint.label",{point:l,showmatch:n})}nodeClicked(l){}deleteNode(){this.changesMade=!0;const l=this.tree.selectedNode();this.tree.removeNode(l)}hasSelectedNode(){return Boolean(this.tree.selectedNode())}isRootNode(){const l=this.tree.selectedNode();return!(!l||null!==this.tree.findParentNode(l))}selectedIsBool(){if(this.tree){const l=this.tree.selectedNode();return l&&l.callerData.point.bool_op()}return!1}addChildNode(){this.changesMade=!0;const l=this.tree.selectedNode(),n=this.idl.create("vmsp");n.id(this.newId--),n.isnew(!0),n.parent(l.id),n.match_set(this.matchSet_.id()),n.children([]);const e=this.newPoint.values.pointType;"bool"===e?n.bool_op(this.newPoint.values.boolOp):("attr"===e?n.svf(this.newPoint.values.recordAttr):"marc"===e?(n.tag(this.newPoint.values.marcTag),n.subfield(this.newPoint.values.marcSf)):"heading"===e&&n.heading(!0),n.negate(this.newPoint.values.negate),n.quality(this.newPoint.values.matchScore));const u=new su.b({id:n.id(),callerData:{point:n}});this.setNodeLabel(u,n).then(()=>l.children.push(u))}expressionAsString(){if(!this.tree)return"";const l=n=>n?n.children.length?"("+n.children.map(l).join(" "+n.callerData.slimLabel+" ")+")":n.callerData.point.bool_op()?"()":n.callerData.slimLabel:"";return l(this.tree.rootNode)}saveTree(){const l=n=>{n||(n=this.tree.rootNode);const e=n.callerData.point;return n.children.forEach(n=>e.children().push(l(n))),e},n=l();return this.net.request("open-ils.vandelay","open-ils.vandelay.match_set.update",this.auth.token(),this.matchSet_.id(),n).toPromise().then(l=>this.refreshTree(),l=>console.error(l))}}var cu=u.ob({encapsulation:2,styles:[],data:{}});function bu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["NOT "]))],null,null)}function du(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Normalized Heading"]))],null,null)}function pu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.Kb(1,null,[" ‡",""]))],null,(function(l,n){var e=n.parent.parent.context.point.subfield();l(n,1,0,e)}))}function hu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.Kb(1,null,[" | Match score ",""]))],null,(function(l,n){var e=n.parent.parent.context.point.quality();l(n,1,0,e)}))}function gu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,10,null,null,null,null,null,null,null)),(l()(),u.fb(16777216,null,null,1,null,bu)),u.pb(2,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,du)),u.pb(4,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.qb(5,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.Kb(6,null,["","","",""])),(l()(),u.fb(16777216,null,null,1,null,pu)),u.pb(8,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,hu)),u.pb(10,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(0,null,null,0))],(function(l,n){var e=n.parent.context.point.negate();l(n,2,0,e);var u=n.parent.context.point.heading();l(n,4,0,u);var t=n.parent.context.point.subfield();l(n,8,0,t);var a=n.parent.context.showmatch&&!n.parent.context.point.bool_op();l(n,10,0,a)}),(function(l,n){var e=n.parent.context.point.bool_op(),u=n.parent.context.point.svf(),t=n.parent.context.point.tag();l(n,6,0,e,u,t)}))}function mu(l){return u.Mb(0,[(l()(),u.fb(16777216,null,null,1,null,gu)),u.pb(1,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(0,null,null,0))],(function(l,n){l(n,1,0,n.context.point)}),null)}function fu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"button",[["class","btn btn-outline-dark mr-2"]],null,[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==(l.component.newPointType="attr")&&u),u}),null,null)),(l()(),u.Kb(-1,null,["Record Attribute"]))],null,null)}function vu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"button",[["class","btn btn-outline-dark mr-2"]],null,[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==(l.component.newPointType="heading")&&u),u}),null,null)),(l()(),u.Kb(-1,null,["Normalized Authority Heading"]))],null,null)}function Cu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,2,"div",[["class","row mt-2 ml-2"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,1,"button",[["class","btn btn-success"]],[[8,"disabled",0]],[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==l.component.addChildNode()&&u),u}),null,null)),(l()(),u.Kb(-1,null,[" Add To Selected Node "]))],null,(function(l,n){l(n,1,0,!n.component.selectedIsBool())}))}function yu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,7,"div",[["class","row mt-2 ml-2 font-italic"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,6,"ol",[],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,1,"li",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Define a new match point using the above fields."])),(l()(),u.qb(4,0,null,null,1,"li",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Select a boolean node in the tree."])),(l()(),u.qb(6,0,null,null,1,"li",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,['Click the "Add..." button to add the new matchpoint as a child of the selected node.']))],null,null)}function qu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,8,null,null,null,null,null,null,null)),(l()(),u.qb(1,0,null,null,4,"div",[["class","d-flex"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,1,"button",[["class","btn btn-warning mr-1"]],[[8,"disabled",0]],[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==l.component.deleteNode()&&u),u}),null,null)),(l()(),u.Kb(-1,null,[" Remove Selected Node "])),(l()(),u.qb(4,0,null,null,1,"button",[["class","btn btn-success mr-1"]],[[8,"disabled",0]],[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==l.component.saveTree()&&u),u}),null,null)),(l()(),u.Kb(-1,null,[" Save Changes "])),(l()(),u.qb(6,0,null,null,2,"div",[["class","pt-2"]],null,null,null,null,null)),(l()(),u.qb(7,0,null,null,1,"eg-tree",[],null,[[null,"nodeClicked"]],(function(l,n,e){var u=!0;return"nodeClicked"===n&&(u=!1!==l.component.nodeClicked(e)&&u),u}),Ge.b,Ge.a)),u.pb(8,114688,null,0,ze.a,[],{tree:[0,"tree"]},{nodeClicked:"nodeClicked"})],(function(l,n){l(n,8,0,n.component.tree)}),(function(l,n){var e=n.component;l(n,2,0,!e.hasSelectedNode()||e.isRootNode()),l(n,4,0,!e.changesMade)}))}function ku(l){return u.Mb(0,[u.Ib(402653184,1,{newPoint:0}),(l()(),u.fb(0,[["nodeStrTmpl",2]],null,0,null,mu)),(l()(),u.qb(2,0,null,null,1,"eg-string",[["key","staff.cat.vandelay.matchpoint.label"]],null,null,null,$e.b,$e.a)),u.pb(3,114688,null,0,Ve.a,[u.k,Xe.a],{key:[0,"key"],template:[1,"template"]},null),(l()(),u.qb(4,0,null,null,24,"div",[["class","row mt-2"]],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,20,"div",[["class","col-lg-7"]],null,null,null,null,null)),(l()(),u.qb(6,0,null,null,2,"div",[["class","row ml-2"]],null,null,null,null,null)),(l()(),u.qb(7,0,null,null,1,"span",[["class","text-white bg-dark p-2"]],null,null,null,null,null)),(l()(),u.Kb(8,null,[" Your Expression: "," "])),(l()(),u.qb(9,0,null,null,10,"div",[["class","row ml-2 mt-4"]],null,null,null,null,null)),(l()(),u.qb(10,0,null,null,1,"span",[["class","mr-2"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Add New:"])),(l()(),u.fb(16777216,null,null,1,null,fu)),u.pb(13,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.qb(14,0,null,null,1,"button",[["class","btn btn-outline-dark mr-2"]],null,[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==(l.component.newPointType="marc")&&u),u}),null,null)),(l()(),u.Kb(-1,null,["MARC Tag and Subfield"])),(l()(),u.fb(16777216,null,null,1,null,vu)),u.pb(17,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.qb(18,0,null,null,1,"button",[["class","btn btn-outline-dark mr-2"]],null,[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==(l.component.newPointType="bool")&&u),u}),null,null)),(l()(),u.Kb(-1,null,["Boolean Operator"])),(l()(),u.qb(20,0,null,null,1,"eg-match-set-new-point",[],null,null,null,ou,Ze)),u.pb(21,114688,[[1,4],["newPoint",4]],0,We,[g.a,C.a],{pointType:[0,"pointType"]},null),(l()(),u.fb(16777216,null,null,1,null,Cu)),u.pb(23,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,yu)),u.pb(25,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.qb(26,0,null,null,2,"div",[["class","col-lg-5"]],null,null,null,null,null)),(l()(),u.fb(16777216,null,null,1,null,qu)),u.pb(28,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null)],(function(l,n){var e=n.component;l(n,3,0,"staff.cat.vandelay.matchpoint.label",u.Cb(n,1)),l(n,13,0,"biblio"==e.matchSetType),l(n,17,0,"authority"==e.matchSetType),l(n,21,0,e.newPointType),l(n,23,0,e.newPointType),l(n,25,0,e.newPointType),l(n,28,0,e.tree)}),(function(l,n){l(n,8,0,n.component.expressionAsString())}))}class Tu{constructor(l,n,e,u,t){this.idl=l,this.pcrud=n,this.net=e,this.auth=u,this.org=t,this.dataSource=new en.c,this.dataSource.getRows=(l,n)=>{if(!this.matchSet_)return Object(H.a)();const e={};n.length&&(e.vmsq=n[0].name+" "+n[0].dir);const u={offset:l.offset,limit:l.limit,order_by:e},t={match_set:this.matchSet_.id()};return this.pcrud.search("vmsq",t,u)},this.deleteSelected=l=>{this.pcrud.remove(l).subscribe(l=>console.log("deleted ",l),l=>console.error(l),()=>this.grid.reload())}}set matchSet(l){this.matchSet_=l,l&&(this.matchSetType=l.mtype(),this.grid&&this.grid.reload())}ngOnInit(){}addQuality(){const l=this.idl.create("vmsq"),n=this.newPoint.values;l.match_set(this.matchSet_.id()),l.quality(n.matchScore),l.value(n.value),n.recordAttr?l.svf(n.recordAttr):(l.tag(n.marcTag),l.subfield(n.marcSf)),this.pcrud.create(l).subscribe(l=>console.debug("created ",l),l=>console.error(l),()=>{this.newPointType=null,this.grid.reload()})}}var Iu=u.ob({encapsulation:2,styles:[],data:{}});function Su(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"button",[["class","btn btn-outline-dark mr-2"]],null,[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==(l.component.newPointType="attr")&&u),u}),null,null)),(l()(),u.Kb(-1,null,["Record Attribute"]))],null,null)}function wu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,4,"div",[["class","row mt-2 ml-2"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,1,"button",[["class","btn btn-success mr-2"]],null,[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==l.component.addQuality()&&u),u}),null,null)),(l()(),u.Kb(-1,null,["Add"])),(l()(),u.qb(3,0,null,null,1,"button",[["class","btn btn-warning"]],null,[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==(l.component.newPointType=null)&&u),u}),null,null)),(l()(),u.Kb(-1,null,["Cancel"]))],null,null)}function Mu(l){return u.Mb(0,[u.Ib(402653184,1,{newPoint:0}),u.Ib(402653184,2,{grid:0}),(l()(),u.qb(2,0,null,null,12,"div",[["class","row mt-2"]],null,null,null,null,null)),(l()(),u.qb(3,0,null,null,11,"div",[["class","col-lg-7"]],null,null,null,null,null)),(l()(),u.qb(4,0,null,null,6,"div",[["class","row ml-2 mt-4"]],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,1,"span",[["class","mr-2"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Add New:"])),(l()(),u.fb(16777216,null,null,1,null,Su)),u.pb(8,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.qb(9,0,null,null,1,"button",[["class","btn btn-outline-dark mr-2"]],null,[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==(l.component.newPointType="marc")&&u),u}),null,null)),(l()(),u.Kb(-1,null,["MARC Tag and Subfield"])),(l()(),u.qb(11,0,null,null,1,"eg-match-set-new-point",[],null,null,null,ou,Ze)),u.pb(12,114688,[[1,4],["newPoint",4]],0,We,[g.a,C.a],{isForQuality:[0,"isForQuality"],pointType:[1,"pointType"]},null),(l()(),u.fb(16777216,null,null,1,null,wu)),u.pb(14,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.qb(15,0,null,null,3,"eg-grid",[["idlClass","vmsq"],["persistKey","staff.cat.vandelay.match_set.quality"]],null,null,null,Wl.b,Wl.a)),u.pb(16,4440064,[[2,4],["grid",4]],0,Zl.a,[g.a,m.a,Tl.a,Yl.a],{dataSource:[0,"dataSource"],idlClass:[1,"idlClass"],persistKey:[2,"persistKey"]},null),(l()(),u.qb(17,0,null,null,1,"eg-grid-toolbar-action",[["label","Delete Selected"]],null,null,null,ln.b,ln.a)),u.pb(18,114688,null,0,nn.a,[Zl.a],{label:[0,"label"],action:[1,"action"]},null)],(function(l,n){var e=n.component;l(n,8,0,"biblio"==e.matchSetType),l(n,12,0,!0,e.newPointType),l(n,14,0,e.newPointType),l(n,16,0,e.dataSource,"vmsq","staff.cat.vandelay.match_set.quality"),l(n,18,0,"Delete Selected",e.deleteSelected)}),null)}class Ku{constructor(l,n,e,u){this.router=l,this.route=n,this.pcrud=e,this.org=u,this.route.paramMap.subscribe(l=>{this.matchSetId=+l.get("id"),this.matchSetTab=l.get("matchSetTab")})}ngOnInit(){this.pcrud.retrieve("vms",this.matchSetId).toPromise().then(l=>{l.owner(this.org.get(l.owner())),this.matchSet=l})}onTabChange(l){this.matchSetTab=l.nextId,l.preventDefault(),this.router.navigate([`/staff/cat/vandelay/match_sets/${this.matchSetId}/${this.matchSetTab}`])}}var _u=u.ob({encapsulation:2,styles:[],data:{}});function xu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,20,"div",[["class","row pb-2"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,19,"div",[["class","col-lg-4"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,18,"div",[["class","card tight-card"]],null,null,null,null,null)),(l()(),u.qb(3,0,null,null,1,"h5",[["class","card-header"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Match Set Summary"])),(l()(),u.qb(5,0,null,null,15,"div",[["class","card-body"]],null,null,null,null,null)),(l()(),u.qb(6,0,null,null,4,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(7,0,null,null,1,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Match Set Name:"])),(l()(),u.qb(9,0,null,null,1,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.Kb(10,null,["",""])),(l()(),u.qb(11,0,null,null,4,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(12,0,null,null,1,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Owning Library:"])),(l()(),u.qb(14,0,null,null,1,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.Kb(15,null,["",""])),(l()(),u.qb(16,0,null,null,4,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(17,0,null,null,1,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Type:"])),(l()(),u.qb(19,0,null,null,1,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.Kb(20,null,["",""]))],null,(function(l,n){var e=n.component;l(n,10,0,e.matchSet.name()),l(n,15,0,e.matchSet.owner().shortname()),l(n,20,0,e.matchSet.mtype())}))}function Pu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"eg-match-set-expression",[],null,null,null,ku,cu)),u.pb(1,114688,null,0,iu,[g.a,C.a,f.b,v.a,m.a,Xe.a],{matchSet:[0,"matchSet"]},null)],(function(l,n){l(n,1,0,n.component.matchSet)}),null)}function Au(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"eg-match-set-quality",[],null,null,null,Mu,Iu)),u.pb(1,114688,null,0,Tu,[g.a,C.a,f.b,v.a,m.a],{matchSet:[0,"matchSet"]},null)],(function(l,n){l(n,1,0,n.component.matchSet)}),null)}function Ru(l){return u.Mb(0,[(l()(),u.fb(16777216,null,null,1,null,xu)),u.pb(1,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.qb(2,0,null,null,14,"ngb-tabset",[],null,[[null,"tabChange"]],(function(l,n,e){var u=!0;return"tabChange"===n&&(u=!1!==l.component.onTabChange(e)&&u),u}),r.k,r.f)),u.pb(3,2146304,null,1,A.eb,[A.fb],{activeId:[0,"activeId"]},{tabChange:"tabChange"}),u.Ib(603979776,1,{tabs:1}),(l()(),u.qb(5,0,null,null,5,"ngb-tab",[["id","editor"],["title","Match Set Editor"]],null,null,null,null,null)),u.pb(6,2113536,[[1,4]],2,A.bb,[],{id:[0,"id"],title:[1,"title"]},null),u.Ib(603979776,2,{titleTpls:1}),u.Ib(603979776,3,{contentTpls:1}),(l()(),u.fb(0,null,null,1,null,Pu)),u.pb(10,16384,[[3,4]],0,A.cb,[u.K],null,null),(l()(),u.qb(11,0,null,null,5,"ngb-tab",[["id","quality"],["title","Match Set Quality Metrics"]],null,null,null,null,null)),u.pb(12,2113536,[[1,4]],2,A.bb,[],{id:[0,"id"],title:[1,"title"]},null),u.Ib(603979776,4,{titleTpls:1}),u.Ib(603979776,5,{contentTpls:1}),(l()(),u.fb(0,null,null,1,null,Au)),u.pb(16,16384,[[5,4]],0,A.cb,[u.K],null,null)],(function(l,n){var e=n.component;l(n,1,0,e.matchSet),l(n,3,0,e.matchSetTab),l(n,6,0,"editor","Match Set Editor"),l(n,12,0,"quality","Match Set Quality Metrics")}),null)}function Nu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"ng-component",[],null,null,null,Ru,_u)),u.pb(1,114688,null,0,Ku,[c.l,c.a,C.a,m.a],null,null)],(function(l,n){l(n,1,0)}),null)}var Ou=u.mb("ng-component",Ku,Nu,{},{},[]),Eu=e("MisT"),Du=e("LTyc");class Lu{constructor(l,n,e,u){this.idl=l,this.auth=n,this.pcrud=e,this.vandelay=u,this.refreshInterval=2e3,this.trackers=[]}ngOnInit(){const l=new Date;l.setHours(0),l.setMinutes(0),l.setSeconds(0),this.sinceDate=l.toISOString(),this.pollTrackers()}dateFilterChange(l){l&&(this.sinceDate=l,this.pollTimeout&&(clearTimeout(this.pollTimeout),this.pollTimeout=null),this.trackers=[],this.pollTrackers())}pollTrackers(){const l={"-and":[{"-or":[{workstation:this.auth.user().wsid()},{usr:this.auth.user().id()}]},{"-or":[{create_time:{">=":this.sinceDate}},{state:"active"}]}]};this.pcrud.search("vst",l,{order_by:{vst:"create_time"}}).subscribe(l=>{const n=this.trackers.filter(n=>n.id()===l.id())[0];if(n)n.update_time(l.update_time()),n.state(l.state()),n.total_actions(l.total_actions()),n.actions_performed(l.actions_performed());else{const n=this.trackers.filter(n=>n.session_key()===l.session_key())[0];if(n)if("enqueue"===n.action_type())for(let l=0;l<this.trackers.length;l++){const e=this.trackers[l];if(e.id()===n.id()){console.debug(`removing tracker ${e.id()} from the list`),this.trackers.splice(l,1);break}}else if("import"===n.action_type())return;console.debug(`adding tracker ${l.id()} to list`),this.trackers.unshift(l),this.fleshTrackerQueue(l)}},l=>{},()=>{const l=this.trackers.filter(l=>"active"===l.state());this.pollTimeout=l.length>0?setTimeout(()=>this.pollTrackers(),this.refreshInterval):null})}fleshTrackerQueue(l){const n="bib"===l.record_type()?"vbq":"vaq";this.pcrud.retrieve(n,l.queue()).subscribe(n=>l.queue(n))}}var Fu=u.ob({encapsulation:2,styles:[],data:{}});function Qu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,5,"div",[],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,4,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,3,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(3,0,null,null,2,"div",[["class","alert alert-info"]],null,null,null,null,null)),(l()(),u.qb(4,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["No Import Sessions To Display"]))],null,null)}function Hu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,3,"span",[],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,2,"a",[["class","font-weight-bold"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==u.Cb(l,2).onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)&&t),t}),null,null)),u.pb(2,671744,null,0,c.n,[c.l,c.a,i.m],{routerLink:[0,"routerLink"]},null),(l()(),u.Kb(3,null,[" Queue "," "]))],(function(l,n){var e=u.ub(2,"/staff/cat/vandelay/queue/",n.parent.context.$implicit.record_type(),"/",n.parent.context.$implicit.queue().id(),"");l(n,2,0,e)}),(function(l,n){l(n,1,0,u.Cb(n,2).target,u.Cb(n,2).href);var e=n.parent.context.$implicit.queue().name();l(n,3,0,e)}))}function Bu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"span",[["class","pl-2"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Enqueuing... "]))],null,null)}function Uu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"span",[["class","pl-2"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Importing... "]))],null,null)}function ju(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Active"]))],null,null)}function Gu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Complete"]))],null,null)}function zu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Error"]))],null,null)}function $u(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,2,"span",[["class","pl-3"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,1,"span",[["class","material-icons text-success"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["thumb_up"]))],null,null)}function Vu(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,29,"div",[["class","row mb-4"]],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,28,"div",[["class","col-lg-12"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,27,"div",[["class","card tight-card"]],null,null,null,null,null)),(l()(),u.qb(3,0,null,null,6,"div",[["class","card-header"]],null,null,null,null,null)),(l()(),u.qb(4,0,null,null,5,"div",[["class","panel-title"]],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,4,"span",[],null,null,null,null,null)),(l()(),u.Kb(6,null,[" "," : "])),u.Gb(7,2),(l()(),u.qb(8,0,null,null,1,"span",[["class","font-weight-bold"]],null,null,null,null,null)),(l()(),u.Kb(9,null,["",""])),(l()(),u.qb(10,0,null,null,19,"div",[["class","card-body"]],null,null,null,null,null)),(l()(),u.qb(11,0,null,null,18,"div",[["class","row"]],null,null,null,null,null)),(l()(),u.qb(12,0,null,null,2,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(13,0,null,null,1,"eg-progress-inline",[],null,null,null,L.b,L.a)),u.pb(14,49152,null,0,F.a,[],{max:[0,"max"],value:[1,"value"]},null),(l()(),u.qb(15,0,null,null,14,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.fb(16777216,null,null,1,null,Hu)),u.pb(17,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,Bu)),u.pb(19,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,Uu)),u.pb(21,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,ju)),u.pb(23,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,Gu)),u.pb(25,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,zu)),u.pb(27,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,$u)),u.pb(29,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null)],(function(l,n){var e="complete"==n.context.$implicit.state()?n.context.$implicit.actions_performed():n.context.$implicit.total_actions()||null,u=n.context.$implicit.actions_performed();l(n,14,0,e,u);var t=n.context.$implicit.queue().id;l(n,17,0,t);var a="enqueue"==n.context.$implicit.action_type();l(n,19,0,a);var r="import"==n.context.$implicit.action_type();l(n,21,0,r);var o="active"==n.context.$implicit.state();l(n,23,0,o);var s="complete"==n.context.$implicit.state();l(n,25,0,s);var i="error"==n.context.$implicit.state();l(n,27,0,i);var c="complete"==n.context.$implicit.state();l(n,29,0,c)}),(function(l,n){var e=u.Lb(n,6,0,l(n,7,0,u.Cb(n.parent,0),n.context.$implicit.create_time(),"short"));l(n,6,0,e);var t=n.context.$implicit.name();l(n,9,0,t)}))}function Xu(l){return u.Mb(0,[u.Eb(0,i.f,[u.t]),(l()(),u.qb(1,0,null,null,8,"div",[["class","row mb-2"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,7,"div",[["class","col-lg-6"]],null,null,null,null,null)),(l()(),u.qb(3,0,null,null,6,"div",[["class","input-group"]],null,null,null,null,null)),(l()(),u.qb(4,0,null,null,2,"div",[["class","input-group-prepend"]],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,1,"span",[["class","input-group-text"]],null,null,null,null,null)),(l()(),u.Kb(-1,null,["Show Sessions Since: "])),(l()(),u.qb(7,0,null,null,2,"eg-date-select",[],null,[[null,"onChangeAsIso"]],(function(l,n,e){var u=!0;return"onChangeAsIso"===n&&(u=!1!==l.component.dateFilterChange(e)&&u),u}),Eu.b,Eu.a)),u.Hb(5120,null,_.o,(function(l){return[l]}),[Du.a]),u.pb(9,114688,null,0,Du.a,[],{initialIso:[0,"initialIso"]},{onChangeAsIso:"onChangeAsIso"}),(l()(),u.fb(16777216,null,null,1,null,Qu)),u.pb(11,16384,null,0,i.p,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,Vu)),u.pb(13,278528,null,0,i.o,[u.N,u.K,u.r],{ngForOf:[0,"ngForOf"]},null)],(function(l,n){var e=n.component;l(n,9,0,e.sinceDate),l(n,11,0,0==e.trackers.length),l(n,13,0,e.trackers)}),null)}function Ju(l){return u.Mb(0,[(l()(),u.qb(0,0,null,null,1,"ng-component",[],null,null,null,Xu,Fu)),u.pb(1,114688,null,0,Lu,[g.a,v.a,C.a,T],null,null)],(function(l,n){l(n,1,0)}),null)}var Wu=u.mb("ng-component",Lu,Ju,{},{},[]),Zu=e("EWr9"),Yu=e("EQoe"),lt=e("mW9/"),nt=e("avZ9"),et=e("r7vI"),ut=e("pKmL"),tt=e("9RLy"),at=e("VEwP"),rt=e("tNs6"),ot=e("NR/D"),st=e("r2N+"),it=e("ZqI7"),ct=e("MhCk"),bt=e("MZHd"),dt=e("EBEo"),pt=e("zF8d"),ht=e("csFu"),gt=e("9eSZ"),mt=e("fkVb"),ft=e("9u+K");class vt{}e.d(n,"VandelayModuleNgFactory",(function(){return Ct}));var Ct=u.nb(t,[],(function(l){return u.zb([u.Ab(512,u.j,u.Y,[[8,[a.a,r.a,r.b,r.p,r.q,r.m,r.n,r.o,K,Fl,Jl,cn,Rn,se,pe,ke,Me,Ae,je,Ou,Wu]],[3,u.j],u.w]),u.Ab(4608,i.r,i.q,[u.t,[2,i.S]]),u.Ab(4608,_.D,_.D,[]),u.Ab(4608,_.g,_.g,[]),u.Ab(4608,A.E,A.E,[u.j,u.q,A.Fb,A.F]),u.Ab(4608,i.f,i.f,[u.t]),u.Ab(4608,i.d,i.d,[u.t]),u.Ab(4608,Xe.a,Xe.a,[]),u.Ab(4608,Zu.a,Zu.a,[m.a]),u.Ab(4608,Fn.a,Fn.a,[g.a,f.b,m.a,Zu.a,C.a]),u.Ab(4608,Ql.a,Ql.a,[f.b,C.a,O.a,Yu.a]),u.Ab(4608,lt.a,lt.a,[g.a,f.b,m.a,Zu.a,C.a,Fn.a,Ql.a]),u.Ab(4608,nt.a,nt.a,[m.a]),u.Ab(4608,Ln.a,Ln.a,[f.b,v.a,q.a,Yu.a]),u.Ab(4608,et.a,et.a,[O.a,v.a,f.b,C.a]),u.Ab(4608,fl,vl,[i.e,u.A,gl]),u.Ab(4608,Cl,Cl,[fl,ml]),u.Ab(5120,il,(function(l){return[l]}),[Cl]),u.Ab(4608,pl,pl,[]),u.Ab(6144,dl,null,[pl]),u.Ab(4608,hl,hl,[dl]),u.Ab(6144,z,null,[hl]),u.Ab(4608,G,yl,[z,u.q]),u.Ab(4608,ol,ol,[G]),u.Ab(4608,T,T,[ol,g.a,m.a,q.a,f.b,v.a,C.a,y.a]),u.Ab(1073742336,i.c,i.c,[]),u.Ab(1073742336,_.C,_.C,[]),u.Ab(1073742336,_.l,_.l,[]),u.Ab(1073742336,_.x,_.x,[]),u.Ab(1073742336,c.o,c.o,[[2,c.t],[2,c.l]]),u.Ab(1073742336,A.c,A.c,[]),u.Ab(1073742336,A.f,A.f,[]),u.Ab(1073742336,A.g,A.g,[]),u.Ab(1073742336,A.k,A.k,[]),u.Ab(1073742336,A.l,A.l,[]),u.Ab(1073742336,A.t,A.t,[]),u.Ab(1073742336,A.z,A.z,[]),u.Ab(1073742336,A.G,A.G,[]),u.Ab(1073742336,A.I,A.I,[]),u.Ab(1073742336,A.N,A.N,[]),u.Ab(1073742336,A.U,A.U,[]),u.Ab(1073742336,A.X,A.X,[]),u.Ab(1073742336,A.ab,A.ab,[]),u.Ab(1073742336,A.gb,A.gb,[]),u.Ab(1073742336,A.lb,A.lb,[]),u.Ab(1073742336,A.ob,A.ob,[]),u.Ab(1073742336,A.rb,A.rb,[]),u.Ab(1073742336,A.ub,A.ub,[]),u.Ab(1073742336,A.H,A.H,[]),u.Ab(1073742336,ut.a,ut.a,[]),u.Ab(1073742336,tt.a,tt.a,[]),u.Ab(1073742336,at.a,at.a,[]),u.Ab(1073742336,rt.a,rt.a,[]),u.Ab(1073742336,ot.a,ot.a,[]),u.Ab(1073742336,st.a,st.a,[]),u.Ab(1073742336,it.a,it.a,[]),u.Ab(1073742336,ct.a,ct.a,[]),u.Ab(1073742336,bt.a,bt.a,[]),u.Ab(1073742336,dt.a,dt.a,[]),u.Ab(1073742336,pt.a,pt.a,[]),u.Ab(1073742336,ht.a,ht.a,[]),u.Ab(1073742336,gt.a,gt.a,[]),u.Ab(1073742336,mt.a,mt.a,[]),u.Ab(1073742336,ft.a,ft.a,[]),u.Ab(1073742336,vt,vt,[]),u.Ab(1073742336,ql,ql,[]),u.Ab(1073742336,kl,kl,[]),u.Ab(1073742336,t,t,[]),u.Ab(1024,c.j,(function(){return[[{path:"",component:I,children:[{path:"",pathMatch:"full",redirectTo:"import"},{path:"import",component:Sl},{path:"export",component:Hl},{path:"export/basket",component:Hl},{path:"queue",component:un},{path:"queue/:qtype/:id",component:qn},{path:"queue/:qtype/:id/record/:recordId",component:Wn},{path:"queue/:qtype/:id/record/:recordId/:recordTab",component:Wn},{path:"queue/:qtype/:id/items",component:ie},{path:"display_attrs",component:me},{path:"display_attrs/:atype",component:me},{path:"merge_profiles",component:Te},{path:"holdings_profiles",component:Ke},{path:"match_sets",component:Fe},{path:"match_sets/:id/:matchSetTab",component:Ku},{path:"active_imports",component:Lu}]}]]}),[]),u.Ab(256,gl,"XSRF-TOKEN",[]),u.Ab(256,ml,"X-XSRF-TOKEN",[])])}))},a07c:function(l,n,e){"use strict";e.d(n,"a",(function(){return t})),e.d(n,"b",(function(){return r}));var u=e("8Y7J"),t=(e("ib0n"),e("9rfo"),u.ob({encapsulation:2,styles:[],data:{}}));function a(l){return u.Mb(0,[(l()(),u.fb(0,null,null,0))],null,null)}function r(l){return u.Mb(0,[(l()(),u.fb(0,null,null,0,null,a))],null,null)}},ib0n:function(l,n,e){"use strict";e.d(n,"a",(function(){return u})),e("9rfo");class u{constructor(l){this.combobox=l}ngOnInit(){this.selected&&(this.combobox.startId=this.entryId),this.combobox.addEntry({id:this.entryId,label:this.entryLabel})}}}}]);